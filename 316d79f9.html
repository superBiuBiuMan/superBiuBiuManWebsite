<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>React的学习笔记-(Bilibili李立超) | 梦洁小站-属于你我的小天地</title><meta name="author" content="梦洁"><meta name="copyright" content="梦洁"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="写法的变更之前 12const divNode &#x3D; &lt;div&gt;你好,React&lt;&#x2F;div&gt;ReactDOM.render(divNode,document.getElementById(&#x27;root&#x27;))  会警告 现在 12345&lt;script type&#x3D;&quot;text&#x2F;babel&quot;&gt;    const divNode &#x3D; &amp;"><meta property="og:type" content="article"><meta property="og:title" content="React的学习笔记-(Bilibili李立超)"><meta property="og:url" content="https://www.dreamlove.top/316d79f9.html"><meta property="og:site_name" content="梦洁小站-属于你我的小天地"><meta property="og:description" content="写法的变更之前 12const divNode &#x3D; &lt;div&gt;你好,React&lt;&#x2F;div&gt;ReactDOM.render(divNode,document.getElementById(&#x27;root&#x27;))  会警告 现在 12345&lt;script type&#x3D;&quot;text&#x2F;babel&quot;&gt;    const divNode &#x3D; &amp;"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091818601.png"><meta property="article:published_time" content="2023-02-02T09:39:17.000Z"><meta property="article:modified_time" content="2023-02-02T09:39:17.000Z"><meta property="article:author" content="梦洁"><meta property="article:tag" content="React"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091818601.png"><link rel="shortcut icon" href="https://oss.ypggb.com/i/2025/07/01/pk26bw.png"><link rel="canonical" href="https://www.dreamlove.top/316d79f9.html"><link rel="preconnect" href="https://lib.baomitu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://lib.baomitu.com/font-awesome/6.5.1/css/all.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancyapps-ui/5.0.33/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:{appId:"G7A2D1SYPY",apiKey:"49056313a9be02852c7dbedfcb772831",indexName:"blog",hits:{per_page:20},languages:{input_placeholder:"搜索文章",hits_empty:"找不到您查询的内容：${query}",hits_stats:"找到 ${hits} 条结果，用时 ${time} 毫秒"}},localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,infinitegrid:{js:"https://lib.baomitu.com/egjs-infinitegrid/4.11.1/infinitegrid.min.js",buttonText:"加载更多"},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"React的学习笔记-(Bilibili李立超)",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-02-02 09:39:17"}</script><script>(e=>{e.saveToLocal={set:(e,t,o)=>{if(0===o)return;const a={value:t,expiry:Date.now()+864e5*o};localStorage.setItem(e,JSON.stringify(a))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!(Date.now()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise((o,a)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},Object.keys(t).forEach(e=>{n.setAttribute(e,t[e])}),document.head.appendChild(n)}),e.getCSS=(e,t=!1)=>new Promise((o,a)=>{const n=document.createElement("link");n.rel="stylesheet",n.href=e,t&&(n.id=t),n.onerror=a,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,o())},document.head.appendChild(n)}),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 7.1.1"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://oss.ypggb.com/i/2025/07/01/pk26bw.png" onerror='onerror=null,src="/img/404.png"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">101</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情和链接</span></a></div><div class="menus_item"><a class="site-page" href="/navigation/"><i class="fa-fw fas fa-link"></i><span> 链接导航</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 私有化导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://mark.123916.xyz/"><i class="fa-fw fas fa-database"></i><span> 导航</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cloud.reassurehome.com/"><i class="fa-fw fas fa-hippo"></i><span> Alist(私有)</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://short.123916.xyz/027a2"><i class="fa-fw fas fa-paperclip"></i><span> clash免费订阅地址</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://short.123916.xyz/admin/"><i class="fa-fw fas fa-paperclip"></i><span> 短链接生成</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 好玩的</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://make.girls.moe/#/"><i class="fa-fw fas fa-database"></i><span> 动漫头像制作</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://dfqshy.ysepan.com/"><i class="fa-fw fas fa-database"></i><span> FC游戏大全网盘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yikm.net/"><i class="fa-fw fas fa-database"></i><span> 小霸王</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.return8090.com/"><i class="fa-fw fas fa-database"></i><span> 小霸王(广告多)</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://farm.dreamlove.top"><i class="fa-fw fas fa-database"></i><span> QQ农场经典版</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://codepip.com/"><i class="fa-fw fas fa-database"></i><span> CssGame</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://photo.123916.xyz/"><i class="fa-fw fas fa-database"></i><span> 有趣的照片</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://buy.dreamlove.top/"><i class="fa-fw fas fa-heart"></i><span> 购物</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091818601.png)"><nav id="nav"><span id="blog-info"><a href="/" title="梦洁小站-属于你我的小天地"><span class="site-name">梦洁小站-属于你我的小天地</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情和链接</span></a></div><div class="menus_item"><a class="site-page" href="/navigation/"><i class="fa-fw fas fa-link"></i><span> 链接导航</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 私有化导航</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://mark.123916.xyz/"><i class="fa-fw fas fa-database"></i><span> 导航</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://cloud.reassurehome.com/"><i class="fa-fw fas fa-hippo"></i><span> Alist(私有)</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 工具</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://short.123916.xyz/027a2"><i class="fa-fw fas fa-paperclip"></i><span> clash免费订阅地址</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://short.123916.xyz/admin/"><i class="fa-fw fas fa-paperclip"></i><span> 短链接生成</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 好玩的</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://make.girls.moe/#/"><i class="fa-fw fas fa-database"></i><span> 动漫头像制作</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://dfqshy.ysepan.com/"><i class="fa-fw fas fa-database"></i><span> FC游戏大全网盘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.yikm.net/"><i class="fa-fw fas fa-database"></i><span> 小霸王</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://www.return8090.com/"><i class="fa-fw fas fa-database"></i><span> 小霸王(广告多)</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="http://farm.dreamlove.top"><i class="fa-fw fas fa-database"></i><span> QQ农场经典版</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://codepip.com/"><i class="fa-fw fas fa-database"></i><span> CssGame</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://photo.123916.xyz/"><i class="fa-fw fas fa-database"></i><span> 有趣的照片</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://buy.dreamlove.top/"><i class="fa-fw fas fa-heart"></i><span> 购物</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">React的学习笔记-(Bilibili李立超)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-02-02T09:39:17.000Z" title="发表于 2023-02-02 09:39:17">2023-02-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-02T09:39:17.000Z" title="更新于 2023-02-02 09:39:17">2023-02-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/React/">React</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>72分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="React的学习笔记-(Bilibili李立超)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="写法的变更"><a href="#写法的变更" class="headerlink" title="写法的变更"></a>写法的变更</h2><p>之前</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> divNode = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好,React<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(divNode,<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br></pre></td></tr></table></figure><p>会警告</p><p>现在</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">&quot;text/babel&quot;</span>&gt;</span><br><span class="line">    <span class="keyword">const</span> divNode = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好,React<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">    root.<span class="title function_">render</span>(divNode)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>同时,不支持渲染对象</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> array = [<span class="string">&#x27;动感超人&#x27;</span>,<span class="string">&#x27;西瓜超人&#x27;</span>];<span class="comment">//支持</span></span><br><span class="line">    <span class="keyword">const</span> listObj = [</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">&#x27;李白&#x27;</span>,<span class="attr">sex</span>:<span class="string">&#x27;男&#x27;</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">name</span>:<span class="string">&#x27;李白2&#x27;</span>,<span class="attr">sex</span>:<span class="string">&#x27;男&#x27;</span>&#125;,</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">const</span> divNode = <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>你好,React &#123;listObj&#125;//不支持<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    <span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line">    root.<span class="title function_">render</span>(divNode)</span><br></pre></td></tr></table></figure><p>引入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import ReactDOM from &quot;react-dom/client&quot;</span><br></pre></td></tr></table></figure><h2 id="Card封装为UI"><a href="#Card封装为UI" class="headerlink" title="Card封装为UI"></a>Card封装为UI</h2><ul><li>函数标签体</li><li>传递类名</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Logs</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">Card</span>  <span class="attr">className</span>=<span class="string">&quot;logs&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">LogItem</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Card</span>&gt;</span></span></span><br><span class="line">      )</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Card设置为其添加阴影效果*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Card</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;</span>`<span class="attr">card</span> $&#123;<span class="attr">props.className</span>&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;props.children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="表单的双向绑定"><a href="#表单的双向绑定" class="headerlink" title="表单的双向绑定"></a>表单的双向绑定</h2><ul><li>通过setState和onChange来实现,</li><li><del>非受控 没有使用state,受控,使用了state并绑定了值</del></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Card</span> className=<span class="string">&quot;login-form&quot;</span>&gt;</span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;login-form_item&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">label</span> &gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#x27;label&#x27;</span> &gt;</span>日期:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">&#x27;date&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;inputDate&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;(e)</span> =&gt;</span> setInputDate(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;login-form_item&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#x27;label&#x27;</span>&gt;</span>内容:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;请输入学习内容&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;inputContent&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setInputContent(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;login-form_item&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#x27;label&#x27;</span>&gt;</span>时长:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">placeholder</span>=<span class="string">&#x27;请输入学习时长&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;inputTime&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setInputTime(e.target.value)&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">          <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;login-form_operation&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#x27;login-form_operation_btn&#x27;</span>&gt;</span>添加计划<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">      &lt;/<span class="title class_">Card</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="数据为true的时候才会显示对话框"><a href="#数据为true的时候才会显示对话框" class="headerlink" title="数据为true的时候才会显示对话框"></a>数据为true的时候才会显示对话框</h2><p>别漏掉了大括号哦</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212062228080.png"></p><h2 id="解决对话框层级问题"><a href="#解决对话框层级问题" class="headerlink" title="解决对话框层级问题"></a>解决对话框层级问题</h2><ul><li><p>出现情况:组件默认作为了父组件的后代,被渲染到了页面当中导致出现层级问题</p></li><li><p>解决办法</p><ul><li>和根元素平级</li><li>使用protal把组件渲染到网页指定位置</li></ul></li><li><p>使用方法</p><ul><li><code>index.html</code>添加一个容器</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&#x27;portal-root &#x27;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><ul><li>在使用的地方获取容器DOM</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> protalDOM = <span class="variable language_">document</span>.<span class="title function_">getElement</span>(<span class="string">&#x27;portal-root&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Backdrop</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createProtal</span>(jsx内容,目标位置)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">const</span> divPortal = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;portal-root&#x27;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">ReactDOM</span>.<span class="title function_">createPortal</span>((</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#x27;selfMask&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;props.children&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    ),divPortal)</span><br></pre></td></tr></table></figure></li></ul><h2 id="添加过滤功能"><a href="#添加过滤功能" class="headerlink" title="添加过滤功能"></a>添加过滤功能</h2><ul><li>注意字符串的问题,因为这里用的是全等于号,所以在传出去的时候转化为了数字</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">/*传递值*/</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>.<span class="property">value</span>)</span><br><span class="line">    props.<span class="title function_">onChange</span>(+e.<span class="property">target</span>.<span class="property">value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">select</span> <span class="attr">value</span>=<span class="string">&#123;props.defaultValue&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;2022&#125;</span>&gt;</span>2022<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;2021&#125;</span>&gt;</span>2021<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&#123;2020&#125;</span>&gt;</span>2020<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="create-react-app"><a href="#create-react-app" class="headerlink" title="create-react-app"></a>create-react-app</h2><ul><li><code>React.StrictMode</code>作用<ul><li>使用严格模式去渲染组件</li></ul></li></ul><h2 id="内联样式和行内样式"><a href="#内联样式和行内样式" class="headerlink" title="内联样式和行内样式"></a>内联样式和行内样式</h2><ul><li>这个可以参考,根据state的值动态设置样式</li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212072043785.png"></p><ul><li><code>import &quot;./App.css&quot;</code> 会全局污染吗?<strong>会的</strong>,引入是全局的,其他组件也可以看到<ul><li><code>import &quot;./App.css&quot;</code> 就是全局引入,在App.js当中可以看到,其他组件也都可以使用App.css当中的类名</li></ul></li></ul><h2 id="模块化css-避免全局污染"><a href="#模块化css-避免全局污染" class="headerlink" title="模块化css(避免全局污染 )"></a>模块化css(避免全局污染 )</h2><ol><li>创建一个xxx.module.css</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.p1&#123;</span><br><span class="line">    color:red</span><br><span class="line">&#125;</span><br><span class="line">.app_wrapper&#123;</span><br><span class="line">    color:red</span><br><span class="line">&#125;</span><br><span class="line">.app_wrapper_info &#123;</span><br><span class="line">    background-color: green;</span><br><span class="line">&#125;</span><br><span class="line">.app_wrapper_name &#123;</span><br><span class="line">    background-color: blue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="2"><li>组件中引入</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一般引入的名称为classes</span></span><br><span class="line"><span class="keyword">import</span> classes <span class="keyword">from</span> <span class="string">&quot;./App.module.css&quot;</span>;</span><br></pre></td></tr></table></figure><ol start="3"><li>通过classes来设置类</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注意,最好不要出现除字母,数字,下划线以外的类名</span><br><span class="line">比如出现app-wrapper_name就不要出现&#x27;-&#x27;了</span><br></pre></td></tr></table></figure><ul><li><strong>如果通过.module.css包含标签,比如直接设置div为棕色,依旧会影响到全局组件</strong></li></ul><h2 id="视口的设置"><a href="#视口的设置" class="headerlink" title="视口的设置"></a>视口的设置</h2><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212072138472.png"></p><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><ul><li>避免组件逐层传来传去,就可以使用context</li></ul><p>一种组件通信方式,常用于<code>[祖组件]</code> 和<code>[后代组件]</code>间的通信</p><h2 id="处理字体大小"><a href="#处理字体大小" class="headerlink" title="处理字体大小"></a>处理字体大小</h2><ul><li><p>在小手机是正常的,但是切换到大屏幕的手机就字体就有问题了</p></li><li><p>原因</p><ul><li>像素比问题</li><li>所以不要将字体设置为px,设置为rem即可</li></ul></li><li><p>但是假如你使用了转换插件,并且在input当中的placeholder的时候没有设置字体大小,就会出现这种情况,所以,<strong>最好的预防方法就是将出现字体的地方都设置下字体大小</strong></p></li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212101527215.png"></p><h2 id="public-img和src-asset"><a href="#public-img和src-asset" class="headerlink" title="public&#x2F;img和src&#x2F;asset"></a>public&#x2F;img和src&#x2F;asset</h2><ul><li>public下的可以被服务器所访问,也就是有专门的地址可以看到这个</li><li>src&#x2F;asset不可以被服务器访问,也就是没有入口可以看到这个</li></ul><h2 id="避免事件冒泡"><a href="#避免事件冒泡" class="headerlink" title="避免事件冒泡"></a>避免事件冒泡</h2><ul><li>在div不想被取消回调的div身上添加如下</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className=&#123;classes.<span class="property">detail</span>&#125; onClick=&#123;<span class="function"><span class="params">e</span> =&gt;</span> e.<span class="title function_">stopPropagation</span>()&#125;&gt;</span><br></pre></td></tr></table></figure><h2 id="遮罩层"><a href="#遮罩层" class="headerlink" title="遮罩层"></a>遮罩层</h2><ul><li>遮罩层如果需要接收所有的参数,可以这样子写</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div &#123;...props&#125; className=&#123;<span class="string">`<span class="subst">$&#123;classes.selfMask&#125;</span> <span class="subst">$&#123;props.className&#125;</span>`</span>&#125; &gt;</span><br><span class="line">          &#123;children&#125;</span><br><span class="line">      &lt;/div&gt;</span><br></pre></td></tr></table></figure><ul><li>但是注意,<code>&#123;...props&#125;</code>要写在前面哦,如果写在后面,会覆盖已经书写的<code>className</code>属性</li></ul><h2 id="项目很多情况出现冒泡"><a href="#项目很多情况出现冒泡" class="headerlink" title="项目很多情况出现冒泡"></a>项目很多情况出现冒泡</h2><ul><li>很多情况出现冒泡,都需要在父元素身上绑定下<code>stopPropagation</code></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">e.<span class="property">stopPropagation</span></span><br><span class="line"> &lt;div className=&#123;classes.<span class="property">confirm_operation</span>&#125; onClick=&#123;<span class="function"><span class="params">e</span>=&gt;</span>e.<span class="title function_">stopPropagation</span>()&#125;&gt;</span><br><span class="line">                    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;classes.confirm_operation_cancel&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;cancel&#125;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">                    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;classes.confirm_operation_clear&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;confirm&#125;</span>&gt;</span>清空<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">                &lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="清空购物车后数量没有变化"><a href="#清空购物车后数量没有变化" class="headerlink" title="清空购物车后数量没有变化"></a>清空购物车后数量没有变化</h2><ul><li><p>因为之前的浅拷贝,用的都是从最原始的那个数据,所以想要解决清空购物车后数量 依旧存在的问题,以下二个方法</p><ul><li>使用深拷贝(但是这样子原始数据数量就不会改变了在这个项目里面)</li><li>清空购物车的时候,手动清空下里面的amount</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//手动清空amount数量</span><br><span class="line">temp.list.forEach(item =&gt; item.amount = 0);</span><br><span class="line">temp.total  = 0;</span><br><span class="line">temp.list = [];</span><br><span class="line">temp.money = 0;</span><br><span class="line">setCartData(temp)</span><br></pre></td></tr></table></figure></li></ul><h2 id="useEffect和React严格模式和setState执行流程"><a href="#useEffect和React严格模式和setState执行流程" class="headerlink" title="useEffect和React严格模式和setState执行流程"></a>useEffect和React严格模式和setState执行流程</h2><ul><li>React组件有部分逻辑都可以直接编写到组件的函数体中的，像是对数组调用filter、map等方法，像是判断某个组件是否显示等。但是有一部分逻辑如果直接写在函数体中，会影响到组件的渲染，这部分会产生“副作用”的代码，是一定不能直接写在函数体中。</li><li>例如，如果直接将修改state的逻辑编写到了组件之中，就会导致组件不断的循环渲染，直至调用次数过多内存溢出。</li></ul><h3 id="React-StrictMode"><a href="#React-StrictMode" class="headerlink" title="React.StrictMode"></a>React.StrictMode</h3><ul><li>编写React组件时，我们要极力的避免组件中出现那些会产生“副作用”的代码。同时，如果你的React使用了严格模式，也就是在React中使用了<code>React.StrictMode</code>标签，那么React会非常“智能”的去检查你的组件中是否写有副作用的代码，当然这个智能是加了引号的，我们来看看React官网的文档是如何说明的：</li></ul><p>Strict mode can’t automatically detect side effects for you, but it can help you spot them by making them a little more deterministic. This is done by intentionally double-invoking the following functions:</p><ul><li>Class component <code>constructor</code>, <code>render</code>, and <code>shouldComponentUpdate</code> methods</li><li>Class component static <code>getDerivedStateFromProps</code> method</li><li>Function component bodies</li><li>State updater functions (the first argument to <code>setState</code>)</li><li>Functions passed to <code>useState</code>, <code>useMemo</code>, or <code>useReducer</code></li></ul><p>上文的关键字叫做“double-invoking”即重复调用，这句话是什么意思呢？大概意思就是，React并不能自动替你发现副作用，但是它会想办法让它显现出来，从而让你发现它。那么它是怎么让你发现副作用的呢？React的严格模式，<strong>在处于开发模式</strong>下，会主动的重复调用一些函数，以使副作用显现。所以在处于开发模式且开启了React严格模式时，这些函数会被调用两次：</p><p>类组件的的 <code>constructor</code>, <code>render</code>, 和 <code>shouldComponentUpdate</code> 方法<br>类组件的静态方法 <code>getDerivedStateFromProps</code><br>函数组件的函数体<br>参数为函数的<code>setState</code><br>参数为函数的<code>useState</code>, <code>useMemo</code>, or <code>useReducer</code></p><p>重复的调用会使副作用更容易凸显出来，你可以尝试着在函数组件的函数体中调用一个<code>console.log</code>你会发现它会执行两次，如果你的浏览器中安装了React Developer Tools，第二次调用会显示为灰色。</p><ul><li><p>比如报这个错误<code>Too many re-renders</code>就是我们直接在函数体中调用<code>setState</code>方法,就会触发</p><ul><li>疑问:<strong>不是说,当新的state值和旧值相同的时候,不会触发组件的重新渲染,为什么下面这个代码会呢</strong>?</li><li>解释:<code>setCount</code>被调用的时候,处于渲染阶段,不会判断值是否相同</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt;&#123;</span><br><span class="line">	<span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="title function_">setCount</span>(<span class="number">0</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> (</span><br><span class="line">		<span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">			&#123;count&#125;</span></span><br><span class="line"><span class="language-xml">		&lt;/div</span></span><br><span class="line"><span class="language-xml">	)</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212111824987.png"></p></li></ul><h3 id="函数组件setState-或者是setXXXXX-执行流程"><a href="#函数组件setState-或者是setXXXXX-执行流程" class="headerlink" title="函数组件setState(或者是setXXXXX)执行流程"></a>函数组件setState(或者是setXXXXX)执行流程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">setState() --&gt; dispatchSetData()</span><br><span class="line"></span><br><span class="line">//1.会先判断,组件当前处于什么阶段</span><br><span class="line">如果是渲染阶段 --&gt; 不会检查state的值是否相同</span><br><span class="line">如果不是渲染阶段 --&gt; 会检查state的值是否相同</span><br><span class="line">	- 如果值不相同,则会对组件进行重写渲染</span><br><span class="line">	- 如果值相同,则不会组件进行重写渲染</span><br><span class="line">		如果值相同,React在一些情况下会继续执行当前组件的渲染</span><br><span class="line">		但是这个渲染不会触发其子组件的渲染,这次渲染不会产生实际的效果</span><br><span class="line">		这种情况通常发生在值第一次相同的时候</span><br></pre></td></tr></table></figure><h4 id="示例-非严格模式下"><a href="#示例-非严格模式下" class="headerlink" title="示例(非严格模式下)"></a>示例(非严格模式下)</h4><p>App.jsx</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> B <span class="keyword">from</span> <span class="string">&quot;./B&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;App组件重新渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// handleClick被点击触发的时候</span></span><br><span class="line">    <span class="comment">// 是在非渲染阶段了</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setCount</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 初始化的时候</span></span><br><span class="line"><span class="comment">         *          输出 &#x27;App组件重新渲染了&#x27; 和 &#x27;B组件被重新渲染了&#x27;</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 第一次点击按钮 count 变为 1</span></span><br><span class="line"><span class="comment">         *          输出 &#x27;App组件重新渲染了&#x27; 和 &#x27;B组件被重新渲染了&#x27;</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 第二次点击按钮 count 变为 1</span></span><br><span class="line"><span class="comment">         *          输出 &#x27;App组件重新渲染了&#x27;</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * 第三次点击按钮 count 变为 1</span></span><br><span class="line"><span class="comment">         *          未输出任何内容</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App&#123;count&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>点击我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">B</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>B.jsx</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">B</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B组件被重新渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是B组件</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> B;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="还有这个示例也可以看看-setTimeout是异步的-执行的时候也是处于非渲染阶段-所以这个时候就不会导致重复调用从而产生Too-many-re-renders的报错"><a href="#还有这个示例也可以看看-setTimeout是异步的-执行的时候也是处于非渲染阶段-所以这个时候就不会导致重复调用从而产生Too-many-re-renders的报错" class="headerlink" title="还有这个示例也可以看看,setTimeout是异步的,执行的时候也是处于非渲染阶段,所以这个时候就不会导致重复调用从而产生Too many re-renders的报错"></a>还有这个示例也可以看看,setTimeout是异步的,执行的时候也是处于非渲染阶段,所以这个时候就不会导致重复调用从而产生Too many re-renders的报错</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;App组件重新渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setCount</span>(<span class="number">1</span>)</span><br><span class="line">    &#125;,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App&#123;count&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><ul><li><p><code>useEffect</code>是一个钩子函数,需要一个函数作为参数,<strong>这个作为参数的函数,默认将会在组件渲染完毕后执行</strong>(也就是在非渲染阶段才执行这个回调)</p></li><li><p>在实际开发中,可以将那些会产生副作用的代码编写到<code>useEffect</code>的回调函数中,这样子就可以避免这些代码影响到组件的渲染</p><ul><li><p>在函数组件主体内（这里指在 React 渲染阶段）改变 DOM、添加订阅、设置定时器、记录日志以及执行其他包含副作用的操作都是不被允许的，因为这可能会产生莫名其妙的 bug 并破坏 UI 的一致性。</p></li><li><p>使用 <code>useEffect</code> 完成副作用操作。赋值给 <code>useEffect</code> 的函数会在组件渲染到屏幕之后执行</p></li></ul></li><li><p>说通俗点就是我不可以在渲染阶段去修改state的值,我需要在他渲染完毕后再去修改(就是变根回调的执行时机)</p></li><li><p>如果**不想每次都在渲染阶段useEffect被调用,**我们可以传入第二个参数</p></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">第二个参数为数组(即为依赖项目)</span><br><span class="line"></span><br><span class="line">当数组当中的依赖项发送改变的时候,useEffect才会去调用</span><br><span class="line">通过会将<span class="title class_">Effect</span>当中所有的变量都设置为依赖项目</span><br><span class="line">	这样子一来可以确保这些值发生变化时候,会触发<span class="title class_">Effect</span>变化</span><br><span class="line"></span><br><span class="line">像<span class="title function_">setState</span>()是由钩子函数<span class="title function_">useState</span>()生成的</span><br><span class="line">	<span class="title function_">useState</span>()会确保组件的每次渲染都会获取到相同的<span class="title function_">setState</span>()对象,所以stateState可以不设置进<span class="title class_">Effect</span></span><br><span class="line">    所以下面的setShowDetail,setShowCheckOut,可以写进去,也可以不写进去</span><br><span class="line"></span><br><span class="line">当第二个参数为空数组,则意味着<span class="title class_">Effect</span>只会在组件初始化的时候执行一次 </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//产生一个闭包</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">//确保a为最新值</span></span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">	<span class="title function_">setShowDetail</span>(<span class="literal">false</span>);</span><br><span class="line">	<span class="title function_">setShowCheckOut</span>(<span class="literal">false</span>);</span><br><span class="line">&#125;,[a,setShowDetail,setShowCheckOut])</span><br></pre></td></tr></table></figure><ul><li>结合天俞老师的笔记</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">React</span>中的副作用操作</span><br><span class="line"></span><br><span class="line">* 发ajax请求获取数据</span><br><span class="line">* 设置订阅 /  启动定时器</span><br><span class="line">* 手动更改真实<span class="variable constant_">DOM</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">	<span class="comment">//do something</span></span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//返回的函数将在组件卸载前执行</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//在这里做一些收尾工作,会在下一次effect调用前执行</span></span><br><span class="line">		<span class="comment">//比如清除定时器,取消订阅</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;,[stateValue]) <span class="comment">//如果指定的是 [], 那么回调函数只会在第一次render后执行</span></span><br><span class="line">				<span class="comment">//否者就会里面的值发生变化,就执行一次回调(因为render被重新执行了)</span></span><br></pre></td></tr></table></figure><ul><li>总结<ul><li>如果想每次渲染都执行,第二个参数什么都不写</li><li>如果想只当使用到的变量发生改变重新调用,那么第二个参数以数组的形式传入使用到的变量名(也就是写入依赖项目)</li><li>如果想只执行一次(初始化的时候执行),,第二个参数传入空数组<code>[]</code></li></ul></li></ul><h3 id="通过useEffct改造input"><a href="#通过useEffct改造input" class="headerlink" title="通过useEffct改造input"></a>通过useEffct改造input</h3><ul><li>注释掉的部分为改造前</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useEffect, useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> classes <span class="keyword">from</span> <span class="string">&quot;./index.module.css&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">FontAwesomeIcon</span>&#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/react-fontawesome&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;faSearch&#125; <span class="keyword">from</span> <span class="string">&quot;@fortawesome/free-solid-svg-icons&quot;</span>;</span><br><span class="line"><span class="comment">//import &#123;throttle&#125; from &quot;lodash&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Index</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">/*使用节流*/</span></span><br><span class="line">    <span class="comment">//const handleChange = throttle((e) =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//    props.search(e.target.value);</span></span><br><span class="line">    <span class="comment">//&#125;,150)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> [value,setValue] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setValue</span>(e.<span class="property">target</span>.<span class="property">value</span>.<span class="title function_">trim</span>());<span class="comment">//设置值</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        props.<span class="title function_">search</span>(value);</span><br><span class="line">    &#125;,[value])</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classes.filter&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;classes.filter_search&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">FontAwesomeIcon</span> <span class="attr">className</span>=<span class="string">&#123;classes.filter_search_icon&#125;</span> <span class="attr">icon</span>=<span class="string">&#123;faSearch&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;/*<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">className</span>=<span class="string">&#123;classes.filter_search_input&#125;</span> <span class="attr">placeholder</span>=<span class="string">&#123;</span>&#x27;<span class="attr">请输入关键字</span>&#x27;&#125; <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;/</span>&gt;</span>*/&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">value</span>=<span class="string">&#123;value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleChange&#125;</span> <span class="attr">className</span>=<span class="string">&#123;classes.filter_search_input&#125;</span> <span class="attr">placeholder</span>=<span class="string">&#123;</span>&#x27;<span class="attr">请输入关键字</span>&#x27;&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Index</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h3><ul><li>之前的时候,我设置购物车数量+1,总是会出现多加一次的情况</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*增加*/</span></span><br><span class="line"><span class="title function_">setCartData</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> temp = &#123;...prevState&#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(temp.<span class="property">list</span>.<span class="title function_">includes</span>(item))</span><br><span class="line">    <span class="keyword">if</span>(!temp.<span class="property">list</span>.<span class="title function_">includes</span>(item))&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是不包含&#x27;</span>)</span><br><span class="line">        <span class="comment">//不包含</span></span><br><span class="line">        item.<span class="property">amount</span> = <span class="number">1</span>;</span><br><span class="line">        temp.<span class="property">list</span>.<span class="title function_">push</span>(item);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;我是包含&#x27;</span>)</span><br><span class="line">        <span class="comment">//包含</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;之前&#x27;</span>,item.<span class="property">amount</span>)</span><br><span class="line">        item.<span class="property">amount</span> +=<span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;之后&#x27;</span>,item.<span class="property">amount</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    temp.<span class="property">total</span>++;<span class="comment">//数量+1</span></span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>我点击+号之后,再次点击+号,总是会重复调用</p><p><strong>因为开启了严格模式,会去检查是否有副作用,就会调用二次(因为有时候调用二次副作用就凸显了出来)</strong></p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212111819948.png"></p><h2 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h2><ul><li>操作useState生成的数据,在多个函数对state设置了(state定义和方法的添加不在同一个地方),如下图就是这种情况</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//伪代码-1示例</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [carData,setCatData] = <span class="title function_">useState</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加商品</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">addItme</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//减少商品</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">removeItme</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//清空购物车</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">clearCart</span> = (<span class="params"></span>) =&gt; &#123;&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//伪代码-2示例</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [number,setNumber] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleReduce</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setNumber</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> prevState - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleAdd</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setNumber</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> prevState + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleReduce&#125;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleAdd&#125;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>所以我们可以使用<code>useReducer</code></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">useReducer(reducer,initialArg,init)</span><br><span class="line">参数:</span><br><span class="line">reducer:为一个函数(state,action) =&gt; stateValue</span><br><span class="line">	</span><br><span class="line">	reducer在执行的时候,会收到二个参数</span><br><span class="line">    * state 当前最新的state</span><br><span class="line">    * action(一般叫action) 普通的js对象,可以将要干的事情告诉action,</span><br><span class="line">    * 进而根据action中不同值来执行不同操作</span><br><span class="line">    * 为了避免type无效(区分操作的type),可以无论如何都会返回一个值</span><br><span class="line">    * 说白了reducer就是将对state的不同操作定义在同一个函数当中</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">initialArg: state的初始值,作用和useState()中的值是一样的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">返回值:为数组</span><br><span class="line"></span><br><span class="line">第一个参数: state 用来获取state的值</span><br><span class="line">第二个参数:state修改的派发器</span><br><span class="line">  * 通过派发器可以发送操作state的命令</span><br><span class="line">  * 具体的修改行为将会由另外一个函数(reducer)执行</span><br><span class="line">  </span><br><span class="line">  </span><br></pre></td></tr></table></figure><ul><li>说通俗点就是<strong>dispatch是一个派活的,reducer是干活的,reducer根据指令不同,从事不同工作</strong></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以通过...arg 后输出arg查看所有参数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> [count,countDispatch] =  = <span class="title function_">useReducer</span>(<span class="function">(<span class="params">state,action</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">const</span> &#123; type &#125; = action.<span class="property">type</span>;   </span><br><span class="line">	<span class="keyword">if</span>(type === <span class="string">&#x27;ADD&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(type ===<span class="string">&#x27;SUB&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> state - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> state;<span class="comment">//避免没有type匹配失败导致问题</span></span><br><span class="line">&#125;,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//或者</span></span><br><span class="line"><span class="keyword">const</span> [count,countDispatch] =  = <span class="title function_">useReducer</span>(<span class="function">(<span class="params">state,action</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">const</span> &#123; type &#125; = action.<span class="property">type</span>;   </span><br><span class="line">	<span class="keyword">switch</span>(type)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>: <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>: <span class="keyword">return</span> state -<span class="number">1</span>;</span><br><span class="line">        <span class="attr">default</span>: <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState,useReducer&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">prevState,action</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;type&#125; = action;<span class="comment">//对传递过来的对象进行结构</span></span><br><span class="line">    <span class="keyword">switch</span> (type)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>: <span class="keyword">return</span> prevState - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>: <span class="keyword">return</span> prevState + <span class="number">1</span>;</span><br><span class="line">        <span class="attr">default</span>: <span class="keyword">return</span> prevState;<span class="comment">//避免未知的</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line"><span class="comment">/*    const [number,setNumber] = useState(0);</span></span><br><span class="line"><span class="comment">    const handleReduce = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">        setNumber(prevState =&gt; prevState - 1);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    const handleAdd = () =&gt; &#123;</span></span><br><span class="line"><span class="comment">        setNumber(prevState =&gt; prevState + 1);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line">    <span class="keyword">const</span> [number,numberDispatch] = <span class="title function_">useReducer</span>(reducer,<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*点击按钮,调用指挥者(dispatch),指挥者再去通知reducer执行对应操作*/&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> numberDispatch(&#123;type:&#x27;SUB&#x27;&#125;)&#125;&gt;-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> numberDispatch(&#123;type:&#x27;ADD&#x27;&#125;)&#125;&gt;+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>reduce通常会定义在组件的外部,避免重复创建(注意,是Reducer创建在外面,不是useReducer创建在外面,否则useReudcer创建在外面会提示React Hook “useReducer” cannot be called at the top level. React Hooks must be called in a React function component or a custom React)</strong></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//之前</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">	<span class="keyword">const</span> [count,countDispatch] = <span class="title function_">useReducer</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;,<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改之后</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params"></span>) =&gt; &#123; ... &#125;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">	<span class="keyword">const</span> [count,countDispatch] = <span class="title function_">useReducer</span>(reducer,<span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="React-memo"><a href="#React-memo" class="headerlink" title="React.memo()"></a>React.memo()</h2><ul><li>组件被重新渲染有二种情况<ul><li>第一种: 组件的state状态改变导致重新渲染</li><li>第二种: 父组件重新渲染导致子组件重新渲染</li></ul></li></ul><p>针对下面这种情况,我们就可以使用React.memo,可以看到,在没有使用<code>React.memo</code>的时候,App的值被改变,子组件也跟着改变了</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212130817186.png"></p><ul><li><p>有时候这种渲染很不好,比如我子组件什么都没有变化,就是因为父组件变化了,我就要变化,所以为了避免重复渲染导致性能上的问题,我们可以使用<code>React.memo</code></p></li><li><p>React.memo()是一个高阶函数</p><ul><li>高阶函数就是参数是函数或者返回值是函数的函数</li></ul></li><li><p>经过React.memo()包装过的新组件具有缓存功能</p><ul><li>包装过后,只有当组件的<code>props</code>发生变化后才会触发组件的重新渲染,否则总是返回缓存中结果</li></ul></li><li><p>示例(非严格模式下)</p></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">App</span>.<span class="property">jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">&quot;./component/A&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;App被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [number,setNumer] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setNumer</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> prevState + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>点击我+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;number&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">A</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A.<span class="property">jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> B <span class="keyword">from</span> <span class="string">&quot;./B&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">A</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是A组件</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">B</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">React</span>.<span class="title function_">memo</span>(A);</span><br><span class="line"></span><br><span class="line">B.<span class="property">jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">B</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是B组件</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">React</span>.<span class="title function_">memo</span>(B);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果:点击+1多少次,子组件都不会被重新渲染</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212130818853.png" alt="添加React.memo"></p><h2 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h2><ul><li>使用React.memo后,的确可以做到缓存的功能,但是如果子组件接收了来自父组件通过props传递的函数,在使用React.memo后会发生什么?(复习下React.memo,发生props变化的时候才会重新渲染,否则就不会重新渲染)</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">App</span>.<span class="property">jsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">&quot;./component/A&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;App被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [number,setNumer] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setNumer</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> prevState + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>点击我+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;number&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">A</span> <span class="attr">add</span>=<span class="string">&#123;handleClick&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A.<span class="property">jsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">A</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是A组件</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;props.add&#125;</span>&gt;</span>点击我操作App,使其数字+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">React</span>.<span class="title function_">memo</span>(A);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果图,可以看到,即使使用了<code>React.memo</code>,A组件接收了父组件传递过来的值的时候,依旧会因为父组件的改变而导致组件重新渲染(因为props改变了嘛)</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212130825734.png"></p><ul><li>上述代码示例情况就是因为A组件的重新渲染导致<code>handleClick</code>被重新创建,导致重复渲染后相加的值并不是1了,所以我们可以使用<code>useCalback</code>来创建react中的回调函数去避免这种情况</li><li><code>useCallback</code>是一个钩子函数,用来创建react中的回调函数</li><li><code>useCallback</code>创建的回调函数不会在组件重新渲染时重新创建</li><li><code>useCallback</code>参数</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">参数:</span><br><span class="line">参数1:回调函数</span><br><span class="line">参数2:依赖数组</span><br><span class="line">	当依赖数组的变量发生变化时,回调函数才会重新执行</span><br><span class="line">	如果不指定依赖数组(也就是第二个参数什么都不写),</span><br><span class="line">	回调函数每次被渲染的时候就会被重新执行</span><br><span class="line">	一定要将回调函数中使用到的所有变量设置到依赖当中</span><br><span class="line">		除了setState,因为这个不会变~</span><br></pre></td></tr></table></figure><ul><li><p>总结</p><ul><li>如果想每次渲染都执行,第二个参数什么都不写</li><li>如果想只当使用到的变量发生改变重新调用,那么第二个参数以数组的形式传入使用到的变量名(也就是写入依赖项目)</li><li>如果想只执行一次(初始化的时候执行),第二个参数传入空数组<code>[]</code></li></ul></li><li><p>示例</p></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useCallback, useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> A <span class="keyword">from</span> <span class="string">&quot;./component/A&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;App被渲染了&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> [number,setNumer] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> handleClick = <span class="title function_">useCallback</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="title function_">setNumer</span>(<span class="function"><span class="params">prevState</span> =&gt;</span> prevState + <span class="number">1</span>);</span><br><span class="line">    &#125;,[])</span><br><span class="line">    <span class="comment">//const handleClick = () =&gt; &#123;</span></span><br><span class="line">    <span class="comment">//    setNumer(prevState =&gt; prevState + 1);</span></span><br><span class="line">    <span class="comment">//&#125;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>点击我+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;number&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">A</span> <span class="attr">add</span>=<span class="string">&#123;handleClick&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到,即使App发生了重写渲染,A组件也不会重新渲染,因为App当中的callBack我们设置为了只会在创建的时候执行一次</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212130829779.png" alt="效果图"></p><h2 id="todo-Strapi的使用"><a href="#todo-Strapi的使用" class="headerlink" title="(todo)Strapi的使用"></a>(todo)Strapi的使用</h2><h2 id="使用fetch"><a href="#使用fetch" class="headerlink" title="使用fetch"></a>使用fetch</h2><ul><li>这里简单记录下,具体的可以看<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API/Using_Fetch">@mdn-fetch</a></li><li>需要注意的是<ul><li>也就除了<strong>网络故障时和请求被阻止</strong>,其他情况都是resolve</li><li>所以我们可以通过判断<code>ok</code>来进行相应的操作</li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当接收到一个代表错误的 HTTP 状态码时，从 fetch() 返回的 Promise 不会被标记为 reject，即使响应的 HTTP 状态码是 404 或 500。相反，它会将 Promise 状态标记为 resolve（如果响应的 HTTP 状态码不在 200 - 299 的范围内，则设置 resolve 返回值的 ok 属性为 false），仅当网络故障时或请求被阻止时，才会标记为 reject。</span><br></pre></td></tr></table></figure><ul><li>我们输出查看下请求返回的结果</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:3000/list&#x27;</span>)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212132054940.png"></p><ul><li>所以可以这样子做,处理数据和错误</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:3000/list1414&#x27;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;ok&#125; = res;<span class="comment">//获取请求结果</span></span><br><span class="line">        <span class="keyword">if</span>(ok)&#123;</span><br><span class="line">            <span class="comment">//请求成功</span></span><br><span class="line">            <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;网络异常&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">data</span></span><br><span class="line">                   );<span class="comment">//根据接口不同而返回的数据不同</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">    	<span class="comment">//error.message获取错误文本信息</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>);<span class="comment">//输出错误信息</span></span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure><ul><li>示例student没有做任何逻辑修改,所以只列出app.jsx内容</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState,useEffect&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">StudentList</span> <span class="keyword">from</span> <span class="string">&quot;./components/StudentList&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [stuData, setStuData] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="keyword">const</span> [isLoading,setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>);<span class="comment">//是否正在加载</span></span><br><span class="line">    <span class="keyword">const</span> [isError,setError] = <span class="title function_">useState</span>(<span class="literal">false</span>);<span class="comment">//是否有错误</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">        <span class="title function_">setError</span>(<span class="literal">false</span>)</span><br><span class="line">        <span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:3000/list&#x27;</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">const</span> &#123;ok&#125; = res;<span class="comment">//获取请求结果</span></span><br><span class="line">                <span class="title function_">setLoading</span>(<span class="literal">false</span>);</span><br><span class="line">                <span class="keyword">if</span>(ok)&#123;</span><br><span class="line">                    <span class="comment">//请求成功</span></span><br><span class="line">                    <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;网络异常&#x27;</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">setStuData</span>(res);</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function"><span class="params">error</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="title function_">setError</span>(<span class="literal">true</span>)</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(error.<span class="property">message</span>);<span class="comment">//输出错误信息</span></span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;,[])</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*不处于加载的时候就展示列表*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123; !isLoading &amp;&amp; !isError &amp;&amp; <span class="tag">&lt;<span class="name">StudentList</span> <span class="attr">stus</span>=<span class="string">&#123;stuData&#125;/</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*加载状态*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123; isLoading &amp;&amp; &#x27;加载数据中...&#x27; &#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*是否出错*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;isError &amp;&amp; &#x27;数据出错...&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>当然,你也可以使用<code>async 和 await</code><ul><li>注意;useEffect的第一个参数不能是异步的</li><li>我现在才知道原来<code>try catch</code>后面还有<code>finally</code>…………</li></ul></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState,useEffect&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">StudentList</span> <span class="keyword">from</span> <span class="string">&quot;./components/StudentList&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./App.css&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [stuData, setStuData] = <span class="title function_">useState</span>([]);</span><br><span class="line">    <span class="keyword">const</span> [isLoading,setLoading] = <span class="title function_">useState</span>(<span class="literal">false</span>);<span class="comment">//是否正在加载</span></span><br><span class="line">    <span class="keyword">const</span> [isError,setError] = <span class="title function_">useState</span>(<span class="literal">false</span>);<span class="comment">//是否有错误</span></span><br><span class="line">    <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> <span class="title function_">fetchData</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="title function_">setLoading</span>(<span class="literal">true</span>);</span><br><span class="line">                <span class="title function_">setError</span>(<span class="literal">false</span>)</span><br><span class="line">                <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;http://localhost:3000/list&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span>(res.<span class="property">ok</span>)&#123;</span><br><span class="line">                    <span class="comment">//请求成功</span></span><br><span class="line">                    <span class="keyword">const</span> data = <span class="keyword">await</span> res.<span class="title function_">json</span>();</span><br><span class="line"></span><br><span class="line">                    <span class="title function_">setStuData</span>(data)</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;网络异常&#x27;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (e)&#123;</span><br><span class="line">                <span class="title function_">setError</span>(e)</span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="title function_">setLoading</span>(<span class="literal">false</span>);<span class="comment">//结束加载loading</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">fetchData</span>();</span><br><span class="line">    &#125;,[])</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*不处于加载的时候就展示列表*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123; !isLoading &amp;&amp; !isError &amp;&amp; <span class="tag">&lt;<span class="name">StudentList</span> <span class="attr">stus</span>=<span class="string">&#123;stuData&#125;/</span>&gt;</span> &#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*/!*加载状态*!/*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123; isLoading &amp;&amp; &#x27;加载数据中...&#x27; &#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*/!*是否出错*!/*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;isError &amp;&amp; &#x27;数据出错...&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="自定义钩子-selfHooks"><a href="#自定义钩子-selfHooks" class="headerlink" title="自定义钩子(selfHooks)"></a>自定义钩子(selfHooks)</h2><ul><li>其实自定义钩子就是一个普通函数,只是他的名字需要使用use开头,(自定义钩子就是对其他钩子的封装 )</li></ul><h2 id="redux-RTK-RTKQ"><a href="#redux-RTK-RTKQ" class="headerlink" title="redux,RTK,RTKQ"></a>redux,RTK,RTKQ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">reduex核心思想</span><br><span class="line">	多个state放置在一起去统一管理</span><br><span class="line">	</span><br><span class="line">Reducer</span><br><span class="line">	对于state的所有操作,都保存到同一个函数</span><br><span class="line">	</span><br><span class="line">Store</span><br><span class="line">	仓库对象,无论是订阅还是派发任务,都是通过store</span><br><span class="line">	根据reducer创建对应的store</span><br><span class="line">	</span><br><span class="line">dispatch(Store里面的方法)</span><br><span class="line">	dispatch依旧是告诉reducer怎么去处理state数据</span><br><span class="line">	怎么理解从Store里面调用dispatch呢?因为store根据reducer创建的,所以想要操作数据,自然也应该是从store触发</span><br><span class="line">	</span><br><span class="line">getState(),从store获取数据</span><br><span class="line"></span><br><span class="line">因为redux是适合所有的js的,所以是发布者,订阅者模式</span><br><span class="line">所以store.subscribe(回调函数),发生变化的时候就会执行回调函数</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">prestate,action</span>)&#123;</span><br><span class="line">	preState 即将更新前state的值,reducer的返回值将作为state的新值</span><br><span class="line">	action 是一个普通的js对象,可以保存操作的信息</span><br><span class="line">		type表示操作类型</span><br><span class="line">		其他需要传递的参数,也可以在action设置</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">通常存储的是一个对象</span><br><span class="line"><span class="keyword">const</span> store = <span class="title class_">Redux</span>.<span class="title function_">createStore</span>(reducer,初始值);</span><br><span class="line">	<span class="comment">//也可以在reducer指定初始值</span></span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">reducer</span>(<span class="params">preState = <span class="number">1</span> ,action</span>) &#123;.....&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="redux在html当中的使用"><a href="#redux在html当中的使用" class="headerlink" title="redux在html当中的使用"></a>redux在html当中的使用</h3><ul><li>通过点击增加删除来对数字进行操作</li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212152047750.png"></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">content</span>=<span class="string">&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Redux<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/redux/4.2.0/redux.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;handleClickReduce()&quot;</span>&gt;</span>减少<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;number&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;handeClickAdd()&quot;</span>&gt;</span>增加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> spanNumber = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;number&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 1.创建reducer</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">reducer</span> = (<span class="params">preState,action</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> &#123;type&#125; = action;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">switch</span>(type)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">case</span> <span class="string">&#x27;ADD&#x27;</span>: <span class="keyword">return</span> preState + <span class="number">1</span> ;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">case</span> <span class="string">&#x27;SUB&#x27;</span>: <span class="keyword">return</span> preState - <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">default</span>: <span class="keyword">return</span> preState;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 2.根据reducer创建store</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> store = <span class="title class_">Redux</span>.<span class="title function_">createStore</span>(reducer,<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 4.发生改变的回调</span></span></span><br><span class="line"><span class="language-javascript">    store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;发生改变了&#x27;</span>,store.<span class="title function_">getState</span>())</span></span><br><span class="line"><span class="language-javascript">        spanNumber.<span class="property">textContent</span> = store.<span class="title function_">getState</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">handleClickReduce</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3.store进行改变</span></span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123;<span class="attr">type</span>:<span class="string">&#x27;SUB&#x27;</span>&#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">handeClickAdd</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 3.store进行改变</span></span></span><br><span class="line"><span class="language-javascript">        store.<span class="title function_">dispatch</span>(&#123;<span class="attr">type</span>:<span class="string">&#x27;ADD&#x27;</span>&#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>(todo)如果需要指定加任意数,通过dispatch传递即可(reducer第二个action其实就是一个普通的对象)</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">![](https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212152101002.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### redux的一些缺点</span><br><span class="line"></span><br><span class="line">* 如果state过于复杂,将会非常难于维护</span><br><span class="line">  * 可以通过对state分组进行解决,通过创建多个reducer,然后将其合并为一个</span><br><span class="line">* state每一次操作,都需要对state进行复制,然后再去修改,如果需要修改第三层的值,那岂不是很复杂</span><br><span class="line">* case后边的**常量**维护起来比较麻烦</span><br><span class="line">* 后面二个redux也想到了,所以可以使用`Redux Toolkit(RTK)`,RTK可以完全替换掉redux,RTK包含了redux</span><br><span class="line"></span><br><span class="line">### RTK</span><br><span class="line"></span><br><span class="line">* 安装全套(别忘记安装`react-redux`)</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line"># NPM</span><br><span class="line">npm install @reduxjs/toolkit react-redux</span><br><span class="line"></span><br><span class="line"># Yarn</span><br><span class="line">yarn add @reduxjs/toolkit react-redux</span><br></pre></td></tr></table></figure><ul><li>创建对应的仓库片段</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 创建reducer的切片</span></span><br><span class="line"><span class="comment">//需要一个配置对象作为参数,通过对象的不同属性来指定它的配置</span></span><br><span class="line"><span class="comment">//会自动生成action</span></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;stu&#x27;</span>,<span class="comment">//参与自动生成的action</span></span><br><span class="line">    <span class="comment">//state的初始值</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;动感超人&#x27;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//操作对应的state方法,通过不同方法操作state值</span></span><br><span class="line">    <span class="attr">reducers</span>:&#123;</span><br><span class="line">        <span class="comment">/*这个state是一个state代理,操作这个会影响到store对应的数据*/</span></span><br><span class="line">        <span class="title function_">setName</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            state.<span class="property">name</span> = <span class="string">&#x27;西瓜超人&#x27;</span>;<span class="comment">//直接影响到state数据</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回 &#123;type: &#x27;stu/setName&#x27;, payload: &#x27;进去的参数&#x27;&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(stuSlice.<span class="property">actions</span>.<span class="title function_">setName</span>(<span class="string">&#x27;进去的参数&#x27;</span>));</span><br></pre></td></tr></table></figure><p>输出结果查看<code>stuSlice</code></p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212152140586.png"></p><ul><li>创建reducer并暴露</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice,configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//1. 创建reducer的切片</span></span><br><span class="line"><span class="comment">//需要一个配置对象作为参数,通过对象的不同属性来指定它的配置</span></span><br><span class="line"><span class="comment">//会自动生成action</span></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;stu&#x27;</span>,<span class="comment">//参与自动生成的action</span></span><br><span class="line">    <span class="comment">//state的初始值</span></span><br><span class="line">    <span class="attr">initialState</span>: &#123;</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;动感超人&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>:<span class="number">18</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//操作对应的state方法,通过不同方法操作state值</span></span><br><span class="line">    <span class="attr">reducers</span>:&#123;</span><br><span class="line">        <span class="comment">/*这个state是一个state代理,操作这个会影响到store对应的数据*/</span></span><br><span class="line">        <span class="title function_">setName</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            state.<span class="property">name</span> = <span class="string">&#x27;西瓜超人&#x27;</span>;<span class="comment">//直接影响到state数据</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">setAge</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回 &#123;type: &#x27;stu/setName&#x27;, payload: &#x27;进去的参数&#x27;&#125;</span></span><br><span class="line"><span class="comment">//console.log(stuSlice.actions.setName(&#x27;进去的参数&#x27;));</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//暴露所有生成action的函数</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;setName,setAge&#125; = stuSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建仓库并暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="comment">//reducer:stuSlice,</span></span><br><span class="line">    <span class="comment">//或者传入一个对象</span></span><br><span class="line">        <span class="comment">//key值用于标识不同的reducer</span></span><br><span class="line">        <span class="comment">//value则传入对应的reducer,</span></span><br><span class="line">    <span class="attr">reducer</span>:&#123;</span><br><span class="line">        <span class="attr">student</span>:stuSlice.<span class="property">reducer</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>使用redux<ul><li>传递着<code>使用Provider</code>传递store</li><li>接受者<ul><li>通过<code>useSelectore</code>获取对应的state</li><li>通过<code>useDispatch</code>获取派发操作store的对象(也就是dispatch)</li><li><del>通过暴露的函数生成操作类型和操作值的对象(也就是setName的返回值)</del></li></ul></li></ul></li></ul><p>src&#x2F;index.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store/index&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>App.jsx</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useSelector,useDispatch&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;setName&#125; <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">student</span>);<span class="comment">//获取student的store</span></span><br><span class="line">    <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();<span class="comment">//获取派发器对象</span></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">//传递要设置的新名字</span></span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="title function_">setName</span>(<span class="string">&#x27;我是动感超人&#x27;</span>+<span class="title class_">Date</span>.<span class="title function_">now</span>()))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;store.name&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>更改我的名字<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="存在的一些缺点和解决办法"><a href="#存在的一些缺点和解决办法" class="headerlink" title="存在的一些缺点和解决办法"></a>存在的一些缺点和解决办法</h4><ul><li>如果创建多个切片,并且每一个切片reducers都有setName方法,那么会导致暴露出去的方法重名了</li><li>解决办法:不同的切片不同的文件(其实就是reducers分开)</li></ul><p>store&#x2F;index.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> stuReducer <span class="keyword">from</span> <span class="string">&quot;./stuSlice&quot;</span></span><br><span class="line"><span class="keyword">import</span> addressReducer <span class="keyword">from</span> <span class="string">&quot;./addressSlice&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>:&#123;</span><br><span class="line">        <span class="attr">student</span>: stuReducer,</span><br><span class="line">        <span class="attr">address</span>: addressReducer,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>store&#x2F;stuSlice.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stuSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;stu&#x27;</span>,</span><br><span class="line">    <span class="attr">initialState</span>:&#123;</span><br><span class="line">        <span class="attr">name</span>:<span class="string">&#x27;傻瓜超人&#x27;</span>,</span><br><span class="line">        <span class="attr">age</span>:<span class="number">18</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>:&#123;</span><br><span class="line">        <span class="title function_">setName</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            state.<span class="property">name</span> = action.<span class="property">payload</span>;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">setAge</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            state.<span class="property">age</span> = action.<span class="property">payload</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;setName,setAge&#125; = stuSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> stuSlice.<span class="property">reducer</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>store&#x2F;addressSlice.js</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createSlice&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> addressSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&#x27;address&#x27;</span>,</span><br><span class="line">    <span class="attr">initialState</span>:&#123;</span><br><span class="line">      <span class="attr">address</span>:<span class="string">&#x27;高老庄&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reducers</span>:&#123;</span><br><span class="line">        <span class="title function_">setAddress</span>(<span class="params">state,action</span>)&#123;</span><br><span class="line">            state.<span class="property">address</span> = action.<span class="property">payload</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123;setAddress&#125; = addressSlice.<span class="property">actions</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> addressSlice.<span class="property">reducer</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useSelector,useDispatch&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;setName,setAge&#125; <span class="keyword">from</span> <span class="string">&quot;./store/stuSlice&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;setAddress&#125; <span class="keyword">from</span> <span class="string">&quot;./store/addressSlice&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; student,address &#125;  = <span class="title function_">useSelector</span>(<span class="function"><span class="params">state</span> =&gt;</span> state);</span><br><span class="line">    <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>姓名:&#123;student.name&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>年龄:&#123;student.age&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>地址:&#123;address.address&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(setName(&#x27;张三&#x27;))&#125;&gt;设置姓名为&quot;张三&quot;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(setAge(888))&#125;&gt;设置年龄为888<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> dispatch(setAddress(&#x27;地球村&#x27;))&#125;&gt;设置地址为&quot;地球村&quot;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="RTKQ-redux-toolkit-query"><a href="#RTKQ-redux-toolkit-query" class="headerlink" title="RTKQ(redux toolkit query)"></a>RTKQ(redux toolkit query)</h3><ul><li><p>RTK不仅帮助我们解决了state的问题，同时，它还为我们提供了RTK Query用来帮助我们处理数据加载的问题。RTK Query是一个强大的数据获取和缓存工具。在它的帮助下，Web应用中的加载变得十分简单，它使我们不再需要自己编写获取数据和缓存数据的逻辑。</p></li><li><p>Web应用中加载数据时需要处理的问题：</p><ul><li>根据不同的加载状态显示不同UI组件</li><li>减少对相同数据重复发送请求</li><li>使用乐观更新，提升用户体验</li><li>在用户与UI交互时，管理缓存的生命周期</li></ul></li><li><p>在之前我们就是通过自己每一次发送请求,就创建对应的状态,比如<code>isLoading</code>,<code>isError</code>来处理加载时候的状态的,有了RTKQ,我们就不需要做这些事情了,我们通过RTKQ来帮我们完成这事情</p></li><li><p><strong>更多说明和教学可以看看</strong><a target="_blank" rel="noopener" href="https://www.lilichao.com/index.php/2022/05/27/rtk-query/">@李立超的RTKQ</a></p></li></ul><h4 id="第一步-配置RTKQ"><a href="#第一步-配置RTKQ" class="headerlink" title="第一步:配置RTKQ"></a>第一步:配置RTKQ</h4><p>store&#x2F;studentApi.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApi, fetchBaseQuery&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/dist/query/react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建Api对象</span></span><br><span class="line"><span class="comment">//createApi()用来创建RTKQ中的API对象</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="comment">//Api的reducer标识,不能和其他Api或reducer重复</span></span><br><span class="line">    <span class="attr">reducerPath</span>:<span class="string">&#x27;studentApi&#x27;</span>,</span><br><span class="line">    <span class="comment">//指定查询的基础信息,发送请求使用的工具</span></span><br><span class="line">    <span class="comment">//用来设置发送请求的工具，就是你是用什么发请求，RTKQ为我们提供了fetchBaseQuery作为查询工具，它对fetch进行了简单的封装，很方便，如果你不喜欢可以改用其他工具，这里暂时不做讨论。</span></span><br><span class="line">    <span class="attr">baseQuery</span>:<span class="title function_">fetchBaseQuery</span>(&#123;</span><br><span class="line">        <span class="attr">baseUrl</span>:<span class="string">&#x27;http://localhost:3000/&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//build是请求的构建器,通过build来设置请求相关的信息</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="comment">//使用构建器来创建请求对象</span></span><br><span class="line">            <span class="attr">getStudents</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">arg</span>) &#123;</span><br><span class="line">                    <span class="comment">//用来指定请求的子路径</span></span><br><span class="line">                    <span class="comment">//可以直接返回请求的子路径,默认为get(axios也是默认get方式)</span></span><br><span class="line">                    <span class="comment">//也可以返回配置对象</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span>;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//可以在这里将请求过来的数据进行转换并将结果返回</span></span><br><span class="line">                <span class="title function_">transformResponse</span>(<span class="params">baseQueryReturnValue</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> 转换后的结果</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//api对象创建后,对象中会根据各种方法自动的生成对应的钩子函数</span></span><br><span class="line"><span class="comment">//通过这些钩子函数,可以向服务器发送请求</span></span><br><span class="line"><span class="comment">//钩子函数的命名规则 endpoints中有一个getStudents 结合查询方式=&gt;生成 useGetStudentsQuery</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetStudentsQuery &#125; = studentApi;</span><br><span class="line"></span><br><span class="line"><span class="comment">//我们还需要使用store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> studentApi;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="第二步-创建store对象"><a href="#第二步-创建store对象" class="headerlink" title="第二步:创建store对象"></a>第二步:创建store对象</h4><p>store&#x2F;index.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;configureStore&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> studentApi <span class="keyword">from</span> <span class="string">&quot;./studentApi&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">    <span class="attr">reducer</span>:&#123;</span><br><span class="line">        [studentApi.<span class="property">reducerPath</span>]:studentApi.<span class="property">reducer</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">middleware</span>:<span class="function"><span class="params">getDefaultMiddleware</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//getDefaultMiddleware调用后会返回所有的默认中间件</span></span><br><span class="line">        <span class="comment">//传入studentApi的缓存生效</span></span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getDefaultMiddleware</span>().<span class="title function_">concat</span>(studentApi.<span class="property">middleware</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>随后主入口文件src&#x2F;index.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./store&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="第三步-使用RTKQ"><a href="#第三步-使用RTKQ" class="headerlink" title="第三步:使用RTKQ"></a>第三步:使用RTKQ</h4><ul><li>输出查看调用api中钩子查询的返回值<ul><li>可以看到,输出了三次,可以简单理解为发送前,发送中,发送完成</li><li>每一个阶段都会有具体的字段进行标识,比如<code>isLoading,isFetching,isSuccess,isError</code>等</li><li>这样子就可以便于我们去操作(至少我们不用自己写什么isLoading,isError了,RTKQ帮我们完成了)</li></ul></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useGetStudentsQuery&#125; <span class="keyword">from</span> <span class="string">&quot;./store/studentApi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//调用api查询数据</span></span><br><span class="line">    <span class="comment">//这个钩子函数会返回一个对象作为返回值,请求过程中相关数据都在该对象中</span></span><br><span class="line">    <span class="keyword">const</span> obj = <span class="title function_">useGetStudentsQuery</span>();<span class="comment">//调用Api中的钩子查询数据</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是App</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212171721703.png"></p><ul><li>具体使用示例</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useGetStudentsQuery&#125; <span class="keyword">from</span> <span class="string">&quot;./store/studentApi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">//调用api查询数据</span></span><br><span class="line">    <span class="comment">//这个钩子函数会返回一个对象作为返回值,请求过程中相关数据都在该对象中</span></span><br><span class="line">    <span class="keyword">const</span> &#123; isLoading,data,isSuccess&#125; = <span class="title function_">useGetStudentsQuery</span>();<span class="comment">//调用Api中的钩子查询数据</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123; isLoading &amp;&amp; &#x27;加载中...&#x27;&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;isSuccess &amp;&amp; data.map(item =&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    姓名:&#123;item.name&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    性别:&#123;item.sex&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    年龄:&#123;item.age&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    地址:&#123;item.address&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">p</span>&gt;</span>)</span></span><br><span class="line"><span class="language-xml">            &#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212171727755.png"></p><p>数据库的结构</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212171727591.png"></p><h3 id="编辑信息使用RTK保持最新数据"><a href="#编辑信息使用RTK保持最新数据" class="headerlink" title="编辑信息使用RTK保持最新数据"></a>编辑信息使用RTK保持最新数据</h3><ul><li>在之前编辑学生数据的时候,是通过props来传递数据的,但是如果有一个人修改了数据我们没有更新,就会导致我们编辑的时候使用的是旧数据,用户体验不好</li><li>所以我们可以在编辑的时候重新请求服务器,重新查询数据</li><li>使用RTKQ关键就是如果传参和如何定义接口</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口定义</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">      <span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//build是请求的构建器,通过build来设置请求相关的信息</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">getStudents</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="comment">//用来指定请求的子路径</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="attr">getStudentInfo</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">id</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`students/<span class="subst">$&#123;id&#125;</span>`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;)</span><br><span class="line">  </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetStudentsQuery,useGetStudentInfoQuery&#125; = studentApi;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//传参-使用的时候传参</span></span><br><span class="line"><span class="comment">//传入id,用作查询的参数</span></span><br><span class="line"><span class="keyword">const</span> &#123;data,isSuccess&#125; = <span class="title function_">useGetStudentInfoQuery</span>(props.<span class="property">id</span>);<span class="comment">//异步请求</span></span><br><span class="line"><span class="keyword">const</span> [formData,setFormData] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: props.<span class="property">name</span> ? props.<span class="property">name</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">sex</span>: props.<span class="property">sex</span> ? props.<span class="property">sex</span> : <span class="string">&quot;男&quot;</span>,</span><br><span class="line">        <span class="attr">age</span>: props.<span class="property">age</span> ? props.<span class="property">age</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">address</span>: props.<span class="property">address</span> ? props.<span class="property">address</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="comment">//使用useEffect重新渲染数据当状态改变</span></span><br><span class="line"><span class="comment">//为了避免在渲染中操作state导致无限重复渲染,我们选择在useEffect</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(isSuccess)&#123;</span><br><span class="line">        <span class="title function_">setFormData</span>(&#123;</span><br><span class="line">            ...data,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,[isSuccess])</span><br></pre></td></tr></table></figure><h4 id="设置缓存时间和数据转换-query"><a href="#设置缓存时间和数据转换-query" class="headerlink" title="设置缓存时间和数据转换-query"></a>设置缓存时间和数据转换-query</h4><ul><li>RTKQ是自带缓存的,默认为60秒,</li><li>当我们点击修改的时候,会向后台发送请求,此时数据已经是缓存了,我们再次点击修改,数据已经被缓存,所以不会发送请求了,但是如果有人修改了数据,受到缓存的限制,不会重新请求,所以需要我们可以设置缓存时间<strong>keepUnusedDataFor</strong>,默认是60秒</li><li>每一个接口查询都可以设置缓存时间,默认为60(单位秒)</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">      <span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//build是请求的构建器,通过build来设置请求相关的信息</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">getStudents</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="comment">//用来指定请求的子路径</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="attr">getStudentInfo</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">id</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`students/<span class="subst">$&#123;id&#125;</span>`</span>;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//设置缓存时间为5秒</span></span><br><span class="line">                <span class="attr">keepUnusedDataFor</span>:<span class="number">5</span>,</span><br><span class="line">                <span class="comment">//加工处理请求过来的数据</span></span><br><span class="line">                <span class="title function_">transformResponse</span>(<span class="params">baseQueryReturnValue</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> 转换后的结果</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ....</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="useQuery的返回值查看"><a href="#useQuery的返回值查看" class="headerlink" title="useQuery的返回值查看"></a>useQuery的返回值查看</h3><p>先看图,输出useQuery的返回值</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212171721703.png"></p><ul><li><p><code>refetch</code>函数</p><ul><li>一个函数,用来重新加载数据</li></ul></li><li><p><code>status</code>:string - 请求的状态</p><ul><li>pedding:数据正在加载</li><li>fulfilled:数据加载完成</li></ul></li><li><p><code>isFetching</code>:boolean - <strong>数据是否正在加载</strong>,不管第几次加载,就会设置其状态</p></li><li><p><code>isLoading</code>:boolean - <strong>表示数据是否第一次加载</strong>,通过调用<code>refetch</code>不会改变此状态</p></li><li><p><code>isSuccess</code>:boolean - 请求是否成功</p></li><li><p><code>isUninitialized</code>:boolean -请求是否还没有开始发送,常用在删除操作的请求上</p></li><li><p><code>error</code>:对象 有错才存在对象,无错误就没有这个</p></li><li><p><code>data</code>:最新返回的数据(在重新发送请求的时候,会保存上一次请求返回的数据)</p></li><li><p><code>currentData</code>:当前参数的最新数据,(当参数变化的时候,会清空(变为undefined))</p><ul><li>比如在一个列表搜索想要的汉堡名称,搜索的时候我如果想清空原来的数据并展示等待图标,数据加载完成后才渲染返回的数据,就可以使用<code>currentData</code>,如果不想清空原来的数据,而是等到数据返回后替换原来的数据,就可以使用<code>data</code></li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212172047282.png"></p></li></ul><h3 id="useQuery设置参数"><a href="#useQuery设置参数" class="headerlink" title="useQuery设置参数"></a>useQuery设置参数</h3><ul><li><strong>useQuery第一个参数</strong>可以成为每一个请求的query函数传入的参数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//比如传入id</span></span><br><span class="line"><span class="keyword">import</span> &#123;useGetStudentInfoQuery&#125; <span class="keyword">from</span> <span class="string">&quot;../store/studentApi&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> &#123;data,isSuccess&#125; = <span class="title function_">useGetStudentInfoQuery</span>(id);<span class="comment">//异步请求</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//则我们可以在api当中接收</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="attr">getStudentInfo</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">			<span class="title function_">query</span>(<span class="params">id</span>)&#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">`students/<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line">			&#125;</span><br><span class="line">		j</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li><p><strong>useQuery第二个参数</strong>可以传入对象通过该对象可以对请求进行配置</p><ul><li>创建的时候传入的对api的配置可以说默认配置</li><li>使用的时候传入的第二个参数配置可以更加具有定制化特点,和默认配置发生冲突的时候以这个为准</li></ul></li><li><p><code>selectFromResult</code>函数,返回值作为useQuery返回值</p><ul><li>比如我可以设置data的数据,对data数据进行过滤</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> res = <span class="title function_">useGetStudentsQuery</span>(<span class="literal">null</span>,&#123;</span><br><span class="line">        <span class="attr">selectFromResult</span>: <span class="function">(<span class="params">result</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(result.<span class="property">data</span>)&#123;</span><br><span class="line">                result.<span class="property">data</span>  =  result.<span class="property">data</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">age</span> &lt; <span class="number">18</span>)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li><li><p><code>pollingInterval</code>默认为0,<strong>设置轮询的间隔(隔一段时间发送请求),单位毫秒,为0表示不轮询</strong></p></li><li><p><code>skip</code>设置是否跳过当前请求,默认false</p><ul><li>比如一个组件既有编辑功能,也有添加功能,那么我们需要在添加功能的时候跳过请求,否则就添加的时候就会向后台请求初始化数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当有id的时候,才请求数据,否则不请求</span></span><br><span class="line"><span class="keyword">const</span> &#123;data,isSuccess&#125; = <span class="title function_">useGetStudentInfoQuery</span>(props.<span class="property">id</span>,&#123;</span><br><span class="line">        <span class="attr">skip</span>:!props.<span class="property">id</span>,</span><br><span class="line">&#125;);<span class="comment">//异步请求</span></span><br></pre></td></tr></table></figure></li><li><p><code>refetchOnMountOrArgChange</code>:默认false <strong>设置是否每次都重新加载数据(也就是设置是否不使用缓存)也可以设置为数字,为数字的话就是设置缓存有效期</strong></p></li><li><p><code>refetchOnFocus</code>:默认false, <strong>是否在重新获取焦点时重载数据(比如切换页面)</strong></p><ul><li>如果设置为true,需要在store当中设置<code>setupListeners(store.dispatch)</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;setupListeners&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/query&quot;</span></span><br></pre></td></tr></table></figure></li><li><p><code>refetchOnReConnect</code>:默认false, <strong>是否在重新连接后重载数据</strong>(没网了,重新连接了网)</p></li></ul><h3 id="RTKQ构造器构造API请求"><a href="#RTKQ构造器构造API请求" class="headerlink" title="RTKQ构造器构造API请求"></a>RTKQ构造器构造API请求</h3><ul><li>如果发送的不是get信息(当然,get也可以设置配置对象),我们就不可能像之前写query一样了</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 之前的写法</span></span><br><span class="line"><span class="keyword">const</span> studentAPi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	</span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">getStudent</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">				<span class="title function_">query</span>(<span class="params"></span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果现在是put或者delete或者post,就需要返回配置对象的形式了</span></span><br><span class="line"><span class="comment">//并且更改构建器为mutation</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	</span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">delStudent</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">				<span class="title function_">query</span>(<span class="params">参数</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> &#123;</span><br><span class="line">						<span class="attr">url</span>:<span class="string">&#x27;students/$&#123;参数&#125;&#x27;</span>,</span><br><span class="line">						<span class="attr">method</span>:<span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">						<span class="comment">//如果有参数,则需要添加body</span></span><br><span class="line">						<span class="attr">body</span>:传递的数据</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>删除的调用和查询的调用不太一样,因为删除不是页面加载后就立马删除,而是用户确认删除后才执行删除操作,<strong>添加的操作也是如此,修改的也是</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引入删除的接口</span></span><br><span class="line"><span class="keyword">import</span> &#123;useDelStudentInfoMutation&#125; <span class="keyword">from</span> <span class="string">&quot;../store/studentApi&quot;</span>;</span><br><span class="line"><span class="comment">//输出查看内容</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="title function_">useDelStudentInfoMutation</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印的内容</span></span><br><span class="line">[f,&#123;isError,isLoading,isSuccess,isUninitialized,originalArgs,reset,status&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一个为触发器,第二个是结果集</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//所以具体中我们可以获取触发器,在需要的时候调用就会执行函数</span></span><br><span class="line"><span class="comment">//调用的结果和状态和可以从结果集获取</span></span><br><span class="line"><span class="keyword">const</span> [delStudent,&#123;isSuccess&#125;] = <span class="title function_">useDelStudentInfoMutation</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//点击删除学生,正常的操作应该要询问用户是否删除的</span></span><br><span class="line"><span class="keyword">const</span> handleClick = <span class="title function_">useCallback</span>(<span class="keyword">async</span> (id) =&gt; &#123;</span><br><span class="line">    <span class="title function_">delStudent</span>(id);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>jsx的具体操作添加,修改</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [formData,setFormData] = <span class="title function_">useState</span>(&#123;</span><br><span class="line">	<span class="attr">name</span>: props.<span class="property">name</span> ? props.<span class="property">name</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">	<span class="attr">sex</span>: props.<span class="property">sex</span> ? props.<span class="property">sex</span> : <span class="string">&quot;男&quot;</span>,</span><br><span class="line">	<span class="attr">age</span>: props.<span class="property">age</span> ? props.<span class="property">age</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">	<span class="attr">address</span>: props.<span class="property">address</span> ? props.<span class="property">address</span> : <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//修改数据</span></span><br><span class="line"><span class="keyword">const</span> [editStudentInfo,&#123;<span class="attr">isSuccess</span>:editSuccess&#125;]  = <span class="title function_">useEditStudentInfoMutation</span>();</span><br><span class="line"><span class="comment">//添加数据</span></span><br><span class="line"><span class="keyword">const</span> [addStudent]  = <span class="title function_">useAddStudentInfoMutation</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/*添加回调确认*/</span></span><br><span class="line"><span class="keyword">const</span> handleAdd = <span class="title function_">useCallback</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">	<span class="comment">//执行添加数据</span></span><br><span class="line">	<span class="title function_">addStudent</span>(&#123;</span><br><span class="line">		...formData,</span><br><span class="line">	&#125;);</span><br><span class="line">	<span class="comment">//清空数据</span></span><br><span class="line">	<span class="title function_">setFormData</span>(&#123;</span><br><span class="line">		<span class="attr">name</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="attr">sex</span>: <span class="string">&quot;男&quot;</span>,</span><br><span class="line">		<span class="attr">age</span>:  <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="attr">address</span>:  <span class="string">&quot;&quot;</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">/*修改回调确认*/</span></span><br><span class="line"><span class="keyword">const</span> handleEditConfirm = <span class="title function_">useCallback</span>(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">	<span class="comment">//执行修改数据</span></span><br><span class="line">	<span class="title function_">editStudentInfo</span>(&#123;</span><br><span class="line">		<span class="attr">id</span>:props.<span class="property">id</span>,</span><br><span class="line">		<span class="attr">info</span>:formData,</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;,)</span><br></pre></td></tr></table></figure><p>studentApi.js的query定义</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改数据</span></span><br><span class="line"><span class="attr">editStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">	<span class="title function_">query</span>(<span class="params">newInfo</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">url</span>:<span class="string">`students/<span class="subst">$&#123;newInfo.id&#125;</span>`</span>,</span><br><span class="line">			<span class="attr">method</span>:<span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">			<span class="attr">body</span>:newInfo.<span class="property">info</span>,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;),</span><br><span class="line"><span class="comment">//添加数据</span></span><br><span class="line"><span class="attr">addStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">	<span class="title function_">query</span>(<span class="params">info</span>)&#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">url</span>:<span class="string">&#x27;students&#x27;</span>,</span><br><span class="line">			<span class="attr">method</span>:<span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">			<span class="attr">body</span>:info,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="RTKQ的数据标签"><a href="#RTKQ的数据标签" class="headerlink" title="RTKQ的数据标签"></a>RTKQ的数据标签</h3><ul><li><p>给API切片请求的数据打上标签,当标签失效的时候,就会重新加载标签对应的请求</p></li><li><p>可以看看简述这位人写的<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/71579ee304ca">@知行合一_脚踏实地地-RTKQ中，给Api切片请求的数据打上标签</a></p></li></ul><ol><li>首先我们需要创建标签</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="attr">reducerPath</span>:<span class="string">&#x27;xxxxx&#x27;</span>,</span><br><span class="line">	<span class="comment">//用来指定API中的标签类型</span></span><br><span class="line">	<span class="attr">tagTypes</span>:[<span class="string">&#x27;student&#x27;</span>],</span><br><span class="line">	</span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">buidl</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//....</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="2"><li><p>给请求的数据添加标签</p><ul><li>给API切片的钩子函数添加<code>providesTags</code>属性,属性值可以为数组字符串,数组对象,回调函数</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="attr">tagTypes</span>:[<span class="string">&#x27;student&#x27;</span>],</span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">xxxxx</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">				<span class="title function_">query</span>(<span class="params"></span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> xxxx</span><br><span class="line">				&#125;,</span><br><span class="line">				<span class="attr">providesTags</span>:xxxxx</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>当<code>providesTags</code>为数组字符串的时候<ul><li>等同于数组对象的简写</li><li>只要type和<code>invalidates</code>对应,就会重新请求数据</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">providesTags</span>:[<span class="string">&#x27;student&#x27;</span>];</span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>&#125;]</span><br></pre></td></tr></table></figure><ul><li>当<code>providesTags</code>为数组对象的时候<ul><li>所有数据(type和id)都需要和<code>invalidates</code>对应才会重新请求数据</li><li>id如果是字符串数字,如果有对应的id,依旧会失效</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="number">100</span>&#125;];</span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;100&#x27;</span>&#125;];</span><br></pre></td></tr></table></figure><ul><li>当<code>providesTags</code>为回调函数的时候</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">当providesTags属性的值为回调函数时，可以对标签的生效范围做更细致的划分</span><br><span class="line">参数<span class="number">1</span>：网络请求的返回结果</span><br><span class="line">  参数<span class="number">2</span>：错误信息</span><br><span class="line">  参数<span class="number">3</span>：钩子函数中传入的实参</span><br><span class="line">  <span class="comment">//返回值为一个数组，符合数组元素条件的数据将生效</span></span><br><span class="line"><span class="attr">providesTags</span>:<span class="function">(<span class="params">result,error,params,meta</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> [&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:params.<span class="property">id</span>&#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>给请求的数据<strong>设置要失效的标签</strong></p><ul><li>通过<code>invalidatesTags</code>进行设置</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	<span class="attr">tagTypes</span>:[<span class="string">&#x27;student&#x27;</span>],</span><br><span class="line">	<span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">delStudent</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">				<span class="title function_">query</span>(<span class="params">id</span>)&#123;</span><br><span class="line">					<span class="keyword">return</span> &#123;</span><br><span class="line">						<span class="attr">url</span>:xxxx,</span><br><span class="line">						<span class="attr">method</span>:<span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="attr">invalidatesTags</span>:xxxx</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ul><li>当<code>invalidatesTags</code>为数组字符串时候<ul><li>只要<code>providesTags</code>当中type包含在<code>invalidatesTags</code>,就会重新请求数据</li><li><strong>数组字符串的写法等同于数组对象的简写</strong></li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">invalidatesTags</span>:[<span class="string">&#x27;student&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="attr">providesTags</span>:[<span class="string">&#x27;student&#x27;</span>];<span class="comment">//让其失效</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>&#125;];<span class="comment">//让其失效</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="number">100</span>&#125;];<span class="comment">//让其失效</span></span><br><span class="line"></span><br><span class="line"><span class="attr">invalidatesTags</span>:[<span class="string">&#x27;student&#x27;</span>];</span><br><span class="line">等同于,二个效果是一样的</span><br><span class="line"><span class="attr">invalidatesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>&#125;];</span><br></pre></td></tr></table></figure><ul><li>当<code>invalidatesTags</code>为数组对象的时候<ul><li><strong>指明id则让type和id二者都对应的标签失效</strong></li><li>未指明就和数组字符串失效规则一样</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">invalidates</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="number">10</span>&#125;];</span><br><span class="line"></span><br><span class="line"><span class="attr">providesTags</span>:[<span class="string">&#x27;student&#x27;</span>];<span class="comment">//不会失效</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>&#125;];<span class="comment">//不会失效</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="number">10</span>&#125;];<span class="comment">//会失效</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//实测会</span></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;10&#x27;</span>&#125;];<span class="comment">//会失效</span></span><br><span class="line"></span><br><span class="line"><span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="number">888</span>&#125;];<span class="comment">//不会失效</span></span><br></pre></td></tr></table></figure><ul><li>当<code>invalidatesTags</code>为回调函数的时候</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">invalidatesTags</span>:<span class="function">(<span class="params">result,error,stu,meta</span>) =&gt;</span> </span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> [</span><br><span class="line">        &#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:stu.<span class="property">id</span>&#125;,</span><br><span class="line">        &#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;LIST&#x27;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><ul><li>示例,老师的例子<ul><li>当添加数据后,会刷新列表</li><li>当编辑后,会刷新列表,但是如果数据没有变动的话,点击编辑就不会重新查询(存在缓存的前提下)</li></ul></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApi, fetchBaseQuery&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/dist/query/react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建Api对象</span></span><br><span class="line"><span class="comment">//createApi()用来创建RTKQ中的API对象</span></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="attr">reducerPath</span>:<span class="string">&#x27;studentApi&#x27;</span>,<span class="comment">//Api的标识,不能和其他Api或reducer重复</span></span><br><span class="line">    <span class="comment">//指定查询的基础信息,发送请求使用的工具</span></span><br><span class="line">    <span class="attr">baseQuery</span>:<span class="title function_">fetchBaseQuery</span>(&#123;</span><br><span class="line">        <span class="attr">baseUrl</span>:<span class="string">&#x27;http://localhost:3000/&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">//用来指定api当中的标签</span></span><br><span class="line">    <span class="attr">tagTypes</span>:[<span class="string">&#x27;student&#x27;</span>],</span><br><span class="line">    <span class="attr">endpoints</span>:<span class="function">(<span class="params">build</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//build是请求的构建器,通过build来设置请求相关的信息</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">getStudents</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="comment">//用来指定请求的子路径</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&#x27;students&#x27;</span>;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">providesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;initList&#x27;</span>&#125;]</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="comment">//编辑的时候获取信息</span></span><br><span class="line">            <span class="attr">getStudentInfo</span>:build.<span class="title function_">query</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">id</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`students/<span class="subst">$&#123;id&#125;</span>`</span>;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">providesTags</span>:<span class="function">(<span class="params">result, error, arg, meta</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> [</span><br><span class="line">                        &#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:arg&#125;,</span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">////设置缓存时间为5秒</span></span><br><span class="line">                <span class="comment">//keepUnusedDataFor:5,</span></span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="comment">//删除数据</span></span><br><span class="line">            <span class="attr">delStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">id</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        <span class="attr">url</span>:<span class="string">`students/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">                        <span class="attr">method</span>:<span class="string">&#x27;delete&#x27;</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="attr">invalidatesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;initList&#x27;</span>&#125;]</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="comment">//修改数据</span></span><br><span class="line">            <span class="attr">editStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">newInfo</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        <span class="attr">url</span>:<span class="string">`students/<span class="subst">$&#123;newInfo.id&#125;</span>`</span>,</span><br><span class="line">                        <span class="attr">method</span>:<span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">                        <span class="attr">body</span>:newInfo.<span class="property">info</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//修改数据的时候,只针对修改过的列表进行重新查询数据,未改变的不变动</span></span><br><span class="line">                <span class="attr">invalidatesTags</span>:<span class="function">(<span class="params">result, error, arg, meta</span>) =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> [</span><br><span class="line">                        &#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;initList&#x27;</span>&#125;,</span><br><span class="line">                        &#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:arg.<span class="property">id</span>&#125;,</span><br><span class="line">                    ]</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;),</span><br><span class="line">            <span class="comment">//添加数据</span></span><br><span class="line">            <span class="attr">addStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">                <span class="title function_">query</span>(<span class="params">info</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        <span class="attr">url</span>:<span class="string">&#x27;students&#x27;</span>,</span><br><span class="line">                        <span class="attr">method</span>:<span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">                        <span class="attr">body</span>:info,</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//添加数据的时候重新刷新列表</span></span><br><span class="line">                <span class="attr">invalidatesTags</span>:[&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;initList&#x27;</span>&#125;]</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//api对象创建后,对象中会根据各种方法自动的生成对应的钩子函数</span></span><br><span class="line"><span class="comment">//通过这些钩子函数,可以向服务器发送请求</span></span><br><span class="line"><span class="comment">//钩子函数的命名规则 endpoints中有一个getStudents 结合查询方式=&gt;生成 useGetStudentsQuery</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; useGetStudentsQuery,</span><br><span class="line">    useGetStudentInfoQuery,</span><br><span class="line">    useDelStudentInfoMutation,</span><br><span class="line">    useAddStudentInfoMutation,</span><br><span class="line">    useEditStudentInfoMutation,</span><br><span class="line">&#125; = studentApi;</span><br><span class="line"></span><br><span class="line"><span class="comment">//我们还需要使用store</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> studentApi;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="RTKQ使用axios"><a href="#RTKQ使用axios" class="headerlink" title="RTKQ使用axios"></a>RTKQ使用axios</h3><ul><li>其实使用很简单,就是axios的二次封装</li></ul><ol><li>安装</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure><ol start="2"><li>更改</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApi&#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit/dist/query/react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">	 <span class="attr">reducerPath</span>:<span class="string">&#x27;studentApi&#x27;</span>,<span class="comment">//Api的标识,不能和其他Api或reducer重复</span></span><br><span class="line">    <span class="comment">//指定查询的基础信息,发送请求使用的工具</span></span><br><span class="line">    <span class="comment">//baseQuery:fetchBaseQuery(&#123;</span></span><br><span class="line">    <span class="comment">//    baseUrl:&#x27;http://localhost:3000/&#x27;</span></span><br><span class="line">    <span class="comment">//&#125;),</span></span><br><span class="line">    <span class="comment">//更改为axios</span></span><br><span class="line">    <span class="attr">baseQuery</span>:axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">       <span class="attr">baseURL</span>:<span class="string">&#x27;http://localhost:3000/&#x27;</span></span><br><span class="line">    &#125;),</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="3"><li><p>请求体变更</p><ul><li>比如post或者put等传参需要使用data,而不是body了</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改数据</span></span><br><span class="line"><span class="attr">editStudentInfo</span>:build.<span class="title function_">mutation</span>(&#123;</span><br><span class="line">	<span class="title function_">query</span>(<span class="params">newInfo</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> &#123;</span><br><span class="line">			<span class="attr">url</span>:<span class="string">`students/<span class="subst">$&#123;newInfo.id&#125;</span>`</span>,</span><br><span class="line">			<span class="attr">method</span>:<span class="string">&#x27;put&#x27;</span>,</span><br><span class="line">            <span class="comment">//之前fetch的时候</span></span><br><span class="line">            <span class="comment">//body:newInfo.info</span></span><br><span class="line">			<span class="attr">data</span>:newInfo.<span class="property">info</span>,</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="comment">//修改数据的时候,只针对修改过的列表进行重新查询数据,未改变的不变动</span></span><br><span class="line">	<span class="attr">invalidatesTags</span>:<span class="function">(<span class="params">result, error, arg, meta</span>) =&gt;</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> [</span><br><span class="line">			&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:<span class="string">&#x27;initList&#x27;</span>&#125;,</span><br><span class="line">			&#123;<span class="attr">type</span>:<span class="string">&#x27;student&#x27;</span>,<span class="attr">id</span>:arg.<span class="property">id</span>&#125;,</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure></li></ol><h2 id="react-router-dom-5"><a href="#react-router-dom-5" class="headerlink" title="react-router-dom@5"></a>react-router-dom@5</h2><ul><li>安装</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-router-dom@5</span><br></pre></td></tr></table></figure><ul><li>使用<ul><li><strong>技巧 ,可以为路由模式起别名,当我们更改的时候,就不需要去组件更改了</strong></li></ul></li></ul><p>index.js主入口</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> root = <span class="title class_">ReactDOM</span>.<span class="title function_">createRoot</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>))</span><br><span class="line"></span><br><span class="line">root.<span class="title function_">render</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">App</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>App.jsx</p><ul><li>使用Route对路径进行注册</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>主页<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>关于<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;/&#x27;&#125; <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>&#x27;&#125; <span class="attr">component</span>=<span class="string">&#123;About&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><ul><li>注意<ul><li>默认情况下Route并不是严格匹配,只要url地址的头部和path一致,组件就会挂载,不会检查子路径(也就是说<strong>url地址中包含了path,就会挂载组件</strong>)</li></ul></li><li>所以上述代码会有问题,当我们进入<code>/about</code>的时候,即会加载<code>Home</code>组件和<code>About</code>,因为使用的是模糊匹配,所以我们可以使用精准匹配</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> exact path=&#123;<span class="string">&#x27;/&#x27;</span>&#125; component=&#123;<span class="title class_">Home</span>&#125;&gt;&lt;/<span class="title class_">Route</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>&#x27;&#125; <span class="attr">component</span>=<span class="string">&#123;About&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h3 id="NavLink"><a href="#NavLink" class="headerlink" title="NavLink"></a>NavLink</h3><ul><li><p>特殊版本的Link，可以根据不同的情况设置不同的样式。</p></li><li><p>属性：</p><ol><li><strong>activeClassName</strong> —— 字符串 链接激活时的class</li><li><strong>activeStyle</strong> —— 对象 链接激活时的样式</li><li>isActive —— 函数，可动态判断链接是否激活</li><li>style —— 函数，动态设置样式</li><li>className —— 函数，动态设置class值</li></ol></li></ul><h3 id="Route的传递方式"><a href="#Route的传递方式" class="headerlink" title="Route的传递方式"></a>Route的传递方式</h3><ul><li>方法1 — 通过component</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./Home&quot;</span>;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Route</span>  <span class="attr">path</span>=<span class="string">&quot;/student/:id&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;/</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>方法2-通过render<ul><li>render需要传入一个回调函数,回调函数有一个routeProps参数,返回值为要渲染的组件</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./Home&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//这样子就可以传递数据了,但是不会自动传递match,location,history了</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Route</span>  <span class="attr">path</span>=<span class="string">&quot;/student/:id&quot;</span> <span class="attr">render</span> = <span class="string">&#123;</span> () =&gt;</span> <span class="tag">&lt;<span class="name">Home</span>/&gt;</span> &#125; /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如果需要match.location,history</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/student/:id&quot;</span> <span class="attr">render</span>=<span class="string">&#123;(routeProps)</span> =&gt;</span> <span class="tag">&lt;<span class="name">Home</span> &#123;<span class="attr">...routeProps</span>&#125;/&gt;</span>&#125; /&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>方法3-通过children来指定被挂载的组件</p><ul><li>用法1:<strong>children设置一个回调函数时候</strong>和render类似,写法一样可以说,当,<strong>该组件无论路径是否匹配都会挂载</strong></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/student/:id&quot;</span> children=&#123;<span class="function">(<span class="params">routeProps</span>) =&gt;</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Home</span> &#123;<span class="attr">...routeProps</span>&#125;/&gt;</span></span>&#125;/&gt; </span><br><span class="line">    </span><br><span class="line"><span class="comment">//浏览器</span></span><br><span class="line">    访问/  加载home</span><br><span class="line">    访问/abc 加载home</span><br></pre></td></tr></table></figure><ul><li><p>用法2:传入一个jsx,路径匹配才加载</p><ul><li>当是无法传入match,location,history;但是可以用钩子函数解决</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const match = useRouteMatch()</span><br><span class="line">const location = useLocation();</span><br><span class="line">const history = useHistory();</span><br><span class="line"></span><br><span class="line">const params = useParmas();//获取params参数</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/student/:id&quot;</span> children=&#123; <span class="language-xml">&lt;Home&#125;/&gt;</span>&#125;/&gt; </span><br></pre></td></tr></table></figure></li><li><p>方法4-通过prop.children来</p><ul><li>依据是当路径不匹配依旧会挂载</li></ul></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/student/:id&quot;</span>&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">Home</span>/&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Route</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果需要match location history</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/student/:id&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">	&#123;</span></span><br><span class="line"><span class="language-xml">		routeProps =&gt; <span class="tag">&lt;<span class="name">Home</span> &#123;<span class="attr">...routeProps</span>&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">	&#125;</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>传递的三大属性</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">match</span>:&#123;</span><br><span class="line">    isExact 检查路径是否完全匹配</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125; (默认空对象)请求的参数</span><br><span class="line">    <span class="attr">path</span>:设置的path属性 比如/student /student/:id</span><br><span class="line">    <span class="attr">url</span>: 真实的路径比如/student /student/<span class="number">4</span></span><br><span class="line">&#125; 匹配的信息</span><br><span class="line">		</span><br><span class="line"><span class="attr">location</span>: &#123;</span><br><span class="line">    <span class="attr">has</span>:</span><br><span class="line">    <span class="attr">key</span>:请求的id</span><br><span class="line">    <span class="attr">search</span>:(默认<span class="literal">undefined</span>)查询的字符串比如/student?name=admin</span><br><span class="line">    <span class="attr">state</span>:(默认<span class="literal">undefined</span>)</span><br><span class="line"></span><br><span class="line">&#125;地址信息</span><br><span class="line">		</span><br><span class="line"><span class="attr">history</span>: &#123;</span><br><span class="line">    go自由跳转(方法)</span><br><span class="line">    goBack向后条(方法)</span><br><span class="line">    goForwar向前跳(方法)</span><br><span class="line">    <span class="attr">push</span>:历史记录添加一条新页面并跳转(方法)</span><br><span class="line">    <span class="attr">replace</span>:替换记录并跳转(方法),跳转可以传递state</span><br><span class="line">    <span class="title function_">replace</span>(&#123;<span class="attr">pathname</span>:<span class="string">&#x27;/student/2,state:&#123;name:李白&#125;,)</span></span><br><span class="line"><span class="string">&#125;控制页面的跳转</span></span><br></pre></td></tr></table></figure><h3 id="路由的嵌套"><a href="#路由的嵌套" class="headerlink" title="路由的嵌套"></a>路由的嵌套</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/about&quot;</span>&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">About</span>/&gt;</span></span></span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about/hello&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">		<span class="tag">&lt;<span class="name">Hello</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">	<span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="Prompt组件"><a href="#Prompt组件" class="headerlink" title="Prompt组件"></a>Prompt组件</h3><ul><li>跳转确认</li><li>比如表单输入了,然后用户想跳转到另外一个页面,此时我们就可以使用<code>Prompt</code>组件,询问用户是否跳转</li><li><code>message</code>属性设置提示信息</li><li><code>when</code>属性当为true的时候才会进行循环,默认值是<code>true</code></li><li>下面示例,当input有值的时候,就会进行询问用户是否进行跳转</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123;useState&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Prompt</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">MyForm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [value,setValue] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> [isPrompt,setPrompt] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleOnChange</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">setValue</span>(e.<span class="property">target</span>.<span class="property">value</span>);</span><br><span class="line">        <span class="title function_">setPrompt</span>(!!e.<span class="property">target</span>.<span class="property">value</span>.<span class="title function_">trim</span>().<span class="property">length</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Prompt</span> <span class="attr">message</span>=<span class="string">&#123;</span>&#x27;<span class="attr">确定离开当前页面吗</span>&#x27;&#125; <span class="attr">when</span>=<span class="string">&#123;isPrompt&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>form组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;text&#x27;</span> <span class="attr">value</span>=<span class="string">&#123;value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;handleOnChange&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">MyForm</span>;</span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212201707940.png"></p><h3 id="Redirect"><a href="#Redirect" class="headerlink" title="Redirect"></a>Redirect</h3><ul><li><p><strong>重定向功能</strong></p></li><li><p>属性</p><ul><li><code>to</code></li><li><code>from</code></li><li><code>replace</code>(默认替换方式为replace)</li><li><code>push</code></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当访问abc的时候,自动重定向到form</span></span><br><span class="line">&lt;<span class="title class_">Redirect</span> <span class="keyword">from</span> = <span class="string">&quot;/abc&quot;</span> to=<span class="string">&quot;/form&quot;</span>/&gt;</span><br></pre></td></tr></table></figure></li><li><p>如果有<code>Switch</code>,可以实现重定向功能</p></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Switch</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">component</span>=<span class="string">&#123;About&#125;/</span>&gt;</span></span></span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;/</span>&gt;</span></span></span><br><span class="line">    <span class="comment">//当上面的都匹配不到的时候,就会匹配Redirect组件当中的to值</span></span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">Redirect</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>/&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Switch</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="react-router-dom-6"><a href="#react-router-dom-6" class="headerlink" title="react-router-dom@6"></a>react-router-dom@6</h2><ul><li><p>在react路由@6版本当中,我们必须要在所有的<code>Route</code>外面包一层<code>Routes</code>,作用和<code>Switch</code>类型,<code>Routes</code>中的<code>Route</code>只有一个会被匹配</p></li><li><p><code>Route</code>不再使用<code>component</code>属性,而是<code>element</code>属性</p></li><li><p><code>NavLink</code></p></li><li><p><code>useParams</code>,<code>useLocation</code>没有变化</p></li><li><p><code>useMatch</code>检查当前url<strong>是否匹配某个路由</strong>(注意,是路由,不是路径,比如路由是<code>/student/:id</code>,而不是<code>/student/1</code>)</p><ul><li>匹配:返回一个对象</li><li>不匹配返回null</li></ul></li><li><p><code>useHistory</code>删除,使用<code>useNavigate</code>代替,获取用于跳转页面的函数</p><ul><li><code>const nav = useNavigate();nav(&#39;/home&#39;)跳转到/home</code><strong>默认push方法</strong></li><li><code>nav(&#39;/about&#39;,&#123;replace:true&#125;)</code>,使用replace跳转</li></ul></li><li><p><code>Navigate</code>标签添加</p></li></ul><h3 id="获取params"><a href="#获取params" class="headerlink" title="获取params"></a>获取params</h3><ul><li><code>useParams</code>可以获取params参数<ul><li>比如在路由设置了<code>/home/:id</code>,当我们访问<code>/home/100</code>那么就可以通过useParams获取id信息</li></ul></li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useParams&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">STATIC_DATA</span> = [</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">name</span>:<span class="string">&#x27;傻瓜超人&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">2</span>,<span class="attr">name</span>:<span class="string">&#x27;西瓜超人&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">3</span>,<span class="attr">name</span>:<span class="string">&#x27;动感超人&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">id</span>:<span class="number">4</span>,<span class="attr">name</span>:<span class="string">&#x27;酸梅超人&#x27;</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">About</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;id&#125; = <span class="title function_">useParams</span>();</span><br><span class="line">    <span class="comment">//不要忘记转化为了数字</span></span><br><span class="line">    <span class="keyword">const</span> findData = <span class="variable constant_">STATIC_DATA</span>.<span class="title function_">find</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">id</span> === id*<span class="number">1</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(findData)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>超人的类型<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;findData.id&#125; --- &#123;findData.name&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">About</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="useNavigate-钩子"><a href="#useNavigate-钩子" class="headerlink" title="useNavigate(钩子)"></a>useNavigate(钩子)</h3><ul><li>可以获取一个用于页面跳转的函数</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useNavigate&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> router = <span class="title function_">useNavigate</span>()</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">//使用replace模式(默认不设置是push模式)</span></span><br><span class="line">        <span class="title function_">router</span>(<span class="string">&#x27;/about/1&#x27;</span>,&#123;</span><br><span class="line">            <span class="attr">replace</span>:<span class="literal">true</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是精彩的主页</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>跳转到about页面<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="路由的嵌套和Outlt占位"><a href="#路由的嵌套和Outlt占位" class="headerlink" title="路由的嵌套和Outlt占位"></a>路由的嵌套和Outlt占位</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Routes</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">home</span>&#x27;&#125; <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">Home</span>/&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">    	<span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;<span class="attr">page</span>&#x27;&#125; <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">HomePage</span>/&gt;</span>&#125;/&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>/<span class="attr">:id</span>&#x27;&#125; <span class="attr">element</span>=<span class="string">&#123;</span>&lt;<span class="attr">About</span>/&gt;</span>&#125;&gt; <span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line">&lt;/<span class="title class_">Routes</span>&gt;</span><br></pre></td></tr></table></figure><p>Home.jsx使用Outlet占位</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;useNavigate,<span class="title class_">Outlet</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Home</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> router = <span class="title function_">useNavigate</span>()</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleClick</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="comment">//使用replace模式(默认不设置是push模式)</span></span><br><span class="line">        <span class="title function_">router</span>(<span class="string">&#x27;/about/1&#x27;</span>,&#123;</span><br><span class="line">            <span class="attr">replace</span>:<span class="literal">true</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是精彩的主页</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>跳转到about页面<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Outlet</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Home</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212201828795.png"></p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202212201829549.png"></p><ul><li><code>Outlet</code>表示嵌套路由的组件,当嵌套路由中的路由匹配成功了,Outlet则表示嵌套路由的组件,没有匹配成功的话,Outlet就什么都不是</li></ul><h3 id="Navigate组件"><a href="#Navigate组件" class="headerlink" title="Navigate组件"></a>Navigate组件</h3><ul><li><p><strong>Navigate</strong>只要<strong>被渲染出来,就会引起视图的切换</strong></p></li><li><p><code>replace</code>属性用于控制跳转模式（push 或 replace，默认是push）</p></li></ul><h3 id="NavLink-1"><a href="#NavLink-1" class="headerlink" title="NavLink"></a>NavLink</h3><ul><li>className的方式</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//css内容</span></span><br><span class="line">.<span class="property">active_style</span>&#123;</span><br><span class="line">    background-<span class="attr">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//jsx内容</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>,<span class="title class_">NavLink</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./test.css&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Menu</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">activeStyle</span> = (<span class="params">&#123;isActive&#125;</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> isActive ? <span class="string">&#x27;active_style&#x27;</span> : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">home</span>&#x27;&#125;&gt;</span>Home页面<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*<span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#x27;/home/page&#x27;</span> <span class="attr">className</span>=<span class="string">&#123;activeStyle&#125;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span>*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*或者*/&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">home</span>/<span class="attr">page</span>&#x27;&#125; <span class="attr">className</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                (&#123;<span class="attr">isActive</span>&#125;) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">                    return isActive ? &#x27;active_style&#x27; : null;</span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">            &#125;&gt;Home页面下的page<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>&#x27;&#125;&gt;</span>关于页面<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Menu</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//激活的时候HTML状态</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/home/page&quot;</span> <span class="attr">aria-current</span>=<span class="string">&quot;page&quot;</span> <span class="attr">class</span>=<span class="string">&quot;active_style&quot;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="comment">//未激活的时候HTML状态</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;/home/page&quot;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>style的方式</li></ul><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Link</span>,<span class="title class_">NavLink</span>&#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Menu</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">activeStyle</span> = (<span class="params">&#123;isActive&#125;</span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> isActive ? &#123;<span class="attr">backgroundColor</span>:<span class="string">&#x27;red&#x27;</span>&#125; : <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">home</span>&#x27;&#125;&gt;</span>Home页面<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;/*<span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#x27;/home/page&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;*/&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            &#123;/*    (&#123;<span class="attr">isActive</span>&#125;) =&gt;</span> &#123;*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*        return isActive ? &#123;backgroundColor:&#x27;red&#x27;&#125; : null*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*    &#125;*/&#125;</span></span><br><span class="line"><span class="language-xml">            &#123;/*&#125;&gt;Home页面下的page<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span>*/&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">NavLink</span> <span class="attr">to</span>=<span class="string">&#x27;/home/page&#x27;</span> <span class="attr">style</span>=<span class="string">&#123;activeStyle&#125;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">NavLink</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;</span>&#x27;/<span class="attr">about</span>&#x27;&#125;&gt;</span>关于页面<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Menu</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//激活的时候HTML状态</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">aria-current</span>=<span class="string">&quot;page&quot;</span> <span class="attr">class</span>=<span class="string">&quot;active&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/home/page&quot;</span> <span class="attr">style</span>=<span class="string">&quot;background-color: red;&quot;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//未激活的时候HTML状态</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;/home/page&quot;</span> <span class="attr">style</span>=<span class="string">&quot;&quot;</span>&gt;</span>Home页面下的page<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="其他钩子"><a href="#其他钩子" class="headerlink" title="其他钩子"></a>其他钩子</h2><h3 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h3><ul><li>可以缓存一切,类似于useEffect,useCallback</li><li>useCallback用来缓存函数对象，useMemo用来缓存函数的执行结果</li></ul><h3 id="React-forwardRef和useImperativeHandle"><a href="#React-forwardRef和useImperativeHandle" class="headerlink" title="React.forwardRef和useImperativeHandle"></a>React.forwardRef和useImperativeHandle</h3><ul><li><p>React.forwardRef可以暴露ref对象给外部(比如可以在A组件通过ref来操作B组件当中的input输入框(完整的一个DOM))</p></li><li><p>而useImplerativeHandle可以指定暴露的ref对象给外部(比如A组件可以通过ref来操作B组件当中的input输入框<strong>的值</strong>(只可以操作这个输入框的值))</p></li><li><p>我们先来看看,如果直接给一个自定义组件绑定<code>ref</code>会发生什么</p><ul><li>结果很明显,React提示<code>Warning: Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?</code>,同时,输出ref也无法获取到值多个dom对象,react也不知道要给你谁</li><li>因为无法直接去获取react组件的dom对象,因为一个react组件可以含有</li></ul></li></ul><p>App.jsx组件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useState,useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Some</span> <span class="keyword">from</span> <span class="string">&quot;./component/Some&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> someRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(someRef.<span class="property">current</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>总数:&#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(prevState =&gt; prevState + 1)&#125;&gt;点击加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleShow&#125;</span>&gt;</span>查看Some的ref的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Some</span> <span class="attr">ref</span>=<span class="string">&#123;someRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure><p>Some.jsx组件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Some</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleBtn</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef.<span class="property">current</span>.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            我是Some组件</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleBtn&#125;</span>&gt;</span>获取input的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Some</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202301052109054.png"></p><ul><li>所以我们需要使用<code>React.forwardRef</code>在自定义组件Some当中</li></ul><p>Some.jsx组件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useRef,forwardRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Some</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props,ref</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleBtn</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef.<span class="property">current</span>.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span>&gt;</span>我是Some组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleBtn&#125;</span>&gt;</span>获取input的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Some</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>App.jsx组件</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useState,useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Some</span> <span class="keyword">from</span> <span class="string">&quot;./component/Some&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> someRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(someRef)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>总数:&#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setCount(prevState =&gt; prevState + 1)&#125;&gt;点击加1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleShow&#125;</span>&gt;</span>查看Some的ref的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Some</span> <span class="attr">ref</span>=<span class="string">&#123;someRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202301052115387.png"></p><ul><li>但是这样子使用<code>forwardRef</code>很不安全,因为你在外部组件直接可以操控这个Some组件的input,完完全全拿到了input,相当于你为了量一块钻石的尺寸,把这个钻石送给了比如,所以我们可以使用<code>useImperativeHandle</code>,只把”钻石”的一些属性告诉他</li></ul><p>App.jsx</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useState,useRef&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Some</span> <span class="keyword">from</span> <span class="string">&quot;./component/Some&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">App</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> [count,setCount] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">const</span> someRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleShow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> temp = count + <span class="number">1</span>;</span><br><span class="line">        <span class="title function_">setCount</span>(temp);</span><br><span class="line">        <span class="comment">/*设置Some组件当中的p标签的内容*/</span></span><br><span class="line">        someRef.<span class="property">current</span>.<span class="title function_">setContext</span>(temp)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>总数:&#123;count&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleShow&#125;</span>&gt;</span>点击加1并设置Some组件P的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Some</span> <span class="attr">ref</span>=<span class="string">&#123;someRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Some.jsx</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>,&#123;useRef,forwardRef,useImperativeHandle&#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Some</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props,ref</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>();</span><br><span class="line">    <span class="keyword">const</span> pRef = <span class="title function_">useRef</span>()</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">handleBtn</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef.<span class="property">current</span>.<span class="property">value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">useImperativeHandle</span>(ref,<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">/*返回值将作为App.jsx组件获取到的ref的值*/</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="title function_">setContext</span>(<span class="params">content</span>)&#123;</span><br><span class="line">                pRef.<span class="property">current</span>.<span class="property">textContent</span> = content;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">ref</span>=<span class="string">&#123;pRef&#125;</span>&gt;</span>我是Some组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleBtn&#125;</span>&gt;</span>获取input的值<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Some</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>效果图</p><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202301052125057.gif"></p><h3 id="useEffect和useInsertionEffect和useLayoutEffect"><a href="#useEffect和useInsertionEffect和useLayoutEffect" class="headerlink" title="useEffect和useInsertionEffect和useLayoutEffect"></a>useEffect和useInsertionEffect和useLayoutEffect</h3><ul><li>执行顺序从先到后<code>useInsertionEffect</code> &gt; <code>useLayoutEffect</code> &gt; <code>useEffect</code></li><li>当使用<code>useEffect</code>会出现闪的情况的时候,再考虑用其他二个</li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202301052141624.png"></p><h3 id="useDeferredValue"><a href="#useDeferredValue" class="headerlink" title="useDeferredValue"></a>useDeferredValue</h3><ul><li>当我们多个组件使用同一个state时,组件有可能会互相影响,一个组件卡顿,会导致所有组件都卡</li></ul><h2 id="碎笔记"><a href="#碎笔记" class="headerlink" title="碎笔记"></a>碎笔记</h2><ul><li><p>组件首字母必须要大写</p></li><li><p>react想要取消默认行为,可以通过事件对象来,比如event.preventDefault()取消默认行为,event.stopPropagation()取消事件冒泡</p></li><li><p>props是只读的,不能修改props属性</p></li><li><p>toLocaleString()</p><ul><li>没想到这么多可以使用这个方法</li></ul><p><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202406121033609.png"></p></li><li><p>rsc-函数组件不带props</p></li><li><p>rsi函数组件带props</p></li><li><p>rcc-类组件</p></li><li><p>props.children表示函数的标签体</p></li><li><p>React中的钩子函数只能在函数组件或在自定义钩子中调用(是直接在函数组件使用</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>)&#123;</span><br><span class="line">		usexxxxx,<span class="comment">//错误,这不叫函数组件调用,而是在函数组件的内部函数调用了,错误</span></span><br><span class="line">	&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>在类中直接定义的箭头函数,this永远都指向实例对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">	fn = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">		<span class="comment">//在类中直接定义的箭头函数,this永远都指向实例对象</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="title function_">fn2</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="keyword">const</span> <span class="title function_">fn3</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">			<span class="comment">//这都不是在类中直接定义的箭头函数了,肯定不是指向实例对象</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>为什么路由的时候不能使用超链接来实现路由的跳转?<ul><li>会导致向服务器发送请求重新加载页面,并且如果服务器没有做跳转操作下,在<code>BrowserRouter</code>模式下会发生404的情况通过链接跳转的方式(因为这个请求没有经过react-router进行处理),所以为了避免这种情况有二种解决办法<ol><li>使用HashRouter 服务器不会处理#后面的东东,我们请求localhost&#x2F;#&#x2F;about,服务器只会处理localhost,不会处理&#x2F;about</li><li>如果依旧需要使用BrowserRouter, 就需要修改服务器的配置,将所有请求都转发到index.html</li></ol></li></ul></li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//错误写法</span><br><span class="line">&lt;a href=&quot;/&quot;&gt;跳转到主页&lt;/a&gt;</span><br><span class="line">&lt;a href=&quot;/about&quot;&gt;跳转到关于页&lt;/a&gt;</span><br></pre></td></tr></table></figure><ul><li><code>fetchBaseQuery</code>设置请求头并读取state的值</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">baseQuery</span>: <span class="title function_">fetchBaseQuery</span>(&#123;</span><br><span class="line">        <span class="attr">baseUrl</span>: <span class="string">&quot;http://localhost:1337/api&quot;</span>,</span><br><span class="line">        <span class="attr">prepareHeaders</span>: <span class="function">(<span class="params">headers,abc</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(abc);</span><br><span class="line">            <span class="comment">//输出</span></span><br><span class="line">            	<span class="attr">endpoint</span>: <span class="string">&quot;getStudents&quot;</span></span><br><span class="line">                <span class="attr">extra</span>: <span class="literal">undefined</span></span><br><span class="line">                <span class="attr">forced</span>: <span class="literal">false</span></span><br><span class="line">                <span class="attr">getState</span>: ƒ <span class="title function_">a</span>()</span><br><span class="line">                <span class="attr">type</span>: <span class="string">&quot;query&quot;</span></span><br><span class="line">            <span class="keyword">return</span> headers;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> studentApi = <span class="title function_">createApi</span>(&#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    <span class="attr">baseQuery</span>: <span class="title function_">fetchBaseQuery</span>(&#123;</span><br><span class="line">        <span class="attr">baseUrl</span>: <span class="string">&quot;http://localhost:1337/api&quot;</span>,</span><br><span class="line">        <span class="attr">prepareHeaders</span>: <span class="function">(<span class="params">headers, &#123;getState&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> token = <span class="title function_">getState</span>().<span class="property">auth</span>.<span class="property">token</span>;</span><br><span class="line">            <span class="keyword">return</span> headers;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;),</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><ul><li>钩子只能在React组件和自定义钩子中使用<ul><li>钩子不能再嵌套函数或其他语句(if,switch,for)等中使用</li></ul></li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.dreamlove.top">梦洁</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.dreamlove.top/316d79f9.html">https://www.dreamlove.top/316d79f9.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.dreamlove.top" target="_blank">梦洁小站-属于你我的小天地</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/React/">React</a></div><div class="post_share"><div class="social-share" data-image="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091818601.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/butterfly-extsrc/1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://lib.baomitu.com/butterfly-extsrc/1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/212685ca.html" title="vue3获取ref实例结合ts的InstanceType"><img class="cover" src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091844119.png" onerror='onerror=null,src="/img/404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">vue3获取ref实例结合ts的InstanceType</div></div></a></div><div class="next-post pull-right"><a href="/2e3bcd80.html" title="grid布局的学习"><img class="cover" src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091850528.png" onerror='onerror=null,src="/img/404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">grid布局的学习</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/36e87c18.html" title="React17+React Hook+TS4 最佳实践仿 Jira 企业级项目笔记"><img class="cover" src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091759286.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-08</div><div class="title">React17+React Hook+TS4 最佳实践仿 Jira 企业级项目笔记</div></div></a></div><div><a href="/447d3137.html" title="React的学习笔记-(Bilibili天禹老师)"><img class="cover" src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091819967.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-02-02</div><div class="title">React的学习笔记-(Bilibili天禹老师)</div></div></a></div><div><a href="/192840d8.html" title="Antd React Form.Item内部是自定义组件怎么自定义返回值"><img class="cover" src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202403181552977.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-11-12</div><div class="title">Antd React Form.Item内部是自定义组件怎么自定义返回值</div></div></a></div><div><a href="/bedba37b.html" title="index.min.js1 Warning value should in shape of { value string  number, label ReactNode } when you set labelInValue&#96; to true&#96;"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-13</div><div class="title">index.min.js1 Warning value should in shape of { value string number, label ReactNode } when you set labelInValue&#96; to true&#96;</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="artalk-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://oss.ypggb.com/i/2025/07/01/pk26bw.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="avatar"></div><div class="author-info__name">梦洁</div><div class="author-info__description">小小的字,有大大的梦想~分享我的前端学习过程,经历,错误,和一些其他折腾过程</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">182</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">101</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">73</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/superBiuBiuMan"><i class="fab fa-github"></i><span>关注下我(*￣▽￣*)</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:zmqdream@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">不断更新中,有问题请留言回复(会通过邮箱提醒~)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E6%B3%95%E7%9A%84%E5%8F%98%E6%9B%B4"><span class="toc-number">1.</span> <span class="toc-text">写法的变更</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Card%E5%B0%81%E8%A3%85%E4%B8%BAUI"><span class="toc-number">2.</span> <span class="toc-text">Card封装为UI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A8%E5%8D%95%E7%9A%84%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A"><span class="toc-number">3.</span> <span class="toc-text">表单的双向绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%B8%BAtrue%E7%9A%84%E6%97%B6%E5%80%99%E6%89%8D%E4%BC%9A%E6%98%BE%E7%A4%BA%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">4.</span> <span class="toc-text">数据为true的时候才会显示对话框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%AF%B9%E8%AF%9D%E6%A1%86%E5%B1%82%E7%BA%A7%E9%97%AE%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">解决对话框层级问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%BF%87%E6%BB%A4%E5%8A%9F%E8%83%BD"><span class="toc-number">6.</span> <span class="toc-text">添加过滤功能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#create-react-app"><span class="toc-number">7.</span> <span class="toc-text">create-react-app</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E8%81%94%E6%A0%B7%E5%BC%8F%E5%92%8C%E8%A1%8C%E5%86%85%E6%A0%B7%E5%BC%8F"><span class="toc-number">8.</span> <span class="toc-text">内联样式和行内样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%8C%96css-%E9%81%BF%E5%85%8D%E5%85%A8%E5%B1%80%E6%B1%A1%E6%9F%93"><span class="toc-number">9.</span> <span class="toc-text">模块化css(避免全局污染 )</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%8F%A3%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-number">10.</span> <span class="toc-text">视口的设置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Context"><span class="toc-number">11.</span> <span class="toc-text">Context</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%84%E7%90%86%E5%AD%97%E4%BD%93%E5%A4%A7%E5%B0%8F"><span class="toc-number">12.</span> <span class="toc-text">处理字体大小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#public-img%E5%92%8Csrc-asset"><span class="toc-number">13.</span> <span class="toc-text">public&#x2F;img和src&#x2F;asset</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%BF%E5%85%8D%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1"><span class="toc-number">14.</span> <span class="toc-text">避免事件冒泡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%AE%E7%BD%A9%E5%B1%82"><span class="toc-number">15.</span> <span class="toc-text">遮罩层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E5%BE%88%E5%A4%9A%E6%83%85%E5%86%B5%E5%87%BA%E7%8E%B0%E5%86%92%E6%B3%A1"><span class="toc-number">16.</span> <span class="toc-text">项目很多情况出现冒泡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%90%8E%E6%95%B0%E9%87%8F%E6%B2%A1%E6%9C%89%E5%8F%98%E5%8C%96"><span class="toc-number">17.</span> <span class="toc-text">清空购物车后数量没有变化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useEffect%E5%92%8CReact%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E5%92%8CsetState%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">18.</span> <span class="toc-text">useEffect和React严格模式和setState执行流程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#React-StrictMode"><span class="toc-number">18.1.</span> <span class="toc-text">React.StrictMode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6setState-%E6%88%96%E8%80%85%E6%98%AFsetXXXXX-%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">18.2.</span> <span class="toc-text">函数组件setState(或者是setXXXXX)执行流程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-%E9%9D%9E%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E4%B8%8B"><span class="toc-number">18.2.1.</span> <span class="toc-text">示例(非严格模式下)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%98%E6%9C%89%E8%BF%99%E4%B8%AA%E7%A4%BA%E4%BE%8B%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%9C%8B%E7%9C%8B-setTimeout%E6%98%AF%E5%BC%82%E6%AD%A5%E7%9A%84-%E6%89%A7%E8%A1%8C%E7%9A%84%E6%97%B6%E5%80%99%E4%B9%9F%E6%98%AF%E5%A4%84%E4%BA%8E%E9%9D%9E%E6%B8%B2%E6%9F%93%E9%98%B6%E6%AE%B5-%E6%89%80%E4%BB%A5%E8%BF%99%E4%B8%AA%E6%97%B6%E5%80%99%E5%B0%B1%E4%B8%8D%E4%BC%9A%E5%AF%BC%E8%87%B4%E9%87%8D%E5%A4%8D%E8%B0%83%E7%94%A8%E4%BB%8E%E8%80%8C%E4%BA%A7%E7%94%9FToo-many-re-renders%E7%9A%84%E6%8A%A5%E9%94%99"><span class="toc-number">18.2.2.</span> <span class="toc-text">还有这个示例也可以看看,setTimeout是异步的,执行的时候也是处于非渲染阶段,所以这个时候就不会导致重复调用从而产生Too many re-renders的报错</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useEffect"><span class="toc-number">18.3.</span> <span class="toc-text">useEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E8%BF%87useEffct%E6%94%B9%E9%80%A0input"><span class="toc-number">18.4.</span> <span class="toc-text">通过useEffct改造input</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%96%91%E9%97%AE"><span class="toc-number">18.5.</span> <span class="toc-text">疑问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useReducer"><span class="toc-number">19.</span> <span class="toc-text">useReducer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#React-memo"><span class="toc-number">20.</span> <span class="toc-text">React.memo()</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#useCallback"><span class="toc-number">21.</span> <span class="toc-text">useCallback</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#todo-Strapi%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">22.</span> <span class="toc-text">(todo)Strapi的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8fetch"><span class="toc-number">23.</span> <span class="toc-text">使用fetch</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%92%A9%E5%AD%90-selfHooks"><span class="toc-number">24.</span> <span class="toc-text">自定义钩子(selfHooks)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#redux-RTK-RTKQ"><span class="toc-number">25.</span> <span class="toc-text">redux,RTK,RTKQ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#redux%E5%9C%A8html%E5%BD%93%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">25.1.</span> <span class="toc-text">redux在html当中的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BC%BA%E7%82%B9%E5%92%8C%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95"><span class="toc-number">25.1.1.</span> <span class="toc-text">存在的一些缺点和解决办法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RTKQ-redux-toolkit-query"><span class="toc-number">25.2.</span> <span class="toc-text">RTKQ(redux toolkit query)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5-%E9%85%8D%E7%BD%AERTKQ"><span class="toc-number">25.2.1.</span> <span class="toc-text">第一步:配置RTKQ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5-%E5%88%9B%E5%BB%BAstore%E5%AF%B9%E8%B1%A1"><span class="toc-number">25.2.2.</span> <span class="toc-text">第二步:创建store对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5-%E4%BD%BF%E7%94%A8RTKQ"><span class="toc-number">25.2.3.</span> <span class="toc-text">第三步:使用RTKQ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91%E4%BF%A1%E6%81%AF%E4%BD%BF%E7%94%A8RTK%E4%BF%9D%E6%8C%81%E6%9C%80%E6%96%B0%E6%95%B0%E6%8D%AE"><span class="toc-number">25.3.</span> <span class="toc-text">编辑信息使用RTK保持最新数据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E7%BC%93%E5%AD%98%E6%97%B6%E9%97%B4%E5%92%8C%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2-query"><span class="toc-number">25.3.1.</span> <span class="toc-text">设置缓存时间和数据转换-query</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useQuery%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC%E6%9F%A5%E7%9C%8B"><span class="toc-number">25.4.</span> <span class="toc-text">useQuery的返回值查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useQuery%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">25.5.</span> <span class="toc-text">useQuery设置参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RTKQ%E6%9E%84%E9%80%A0%E5%99%A8%E6%9E%84%E9%80%A0API%E8%AF%B7%E6%B1%82"><span class="toc-number">25.6.</span> <span class="toc-text">RTKQ构造器构造API请求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RTKQ%E7%9A%84%E6%95%B0%E6%8D%AE%E6%A0%87%E7%AD%BE"><span class="toc-number">25.7.</span> <span class="toc-text">RTKQ的数据标签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RTKQ%E4%BD%BF%E7%94%A8axios"><span class="toc-number">25.8.</span> <span class="toc-text">RTKQ使用axios</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#react-router-dom-5"><span class="toc-number">26.</span> <span class="toc-text">react-router-dom@5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NavLink"><span class="toc-number">26.1.</span> <span class="toc-text">NavLink</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Route%E7%9A%84%E4%BC%A0%E9%80%92%E6%96%B9%E5%BC%8F"><span class="toc-number">26.2.</span> <span class="toc-text">Route的传递方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E5%B5%8C%E5%A5%97"><span class="toc-number">26.3.</span> <span class="toc-text">路由的嵌套</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Prompt%E7%BB%84%E4%BB%B6"><span class="toc-number">26.4.</span> <span class="toc-text">Prompt组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Redirect"><span class="toc-number">26.5.</span> <span class="toc-text">Redirect</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#react-router-dom-6"><span class="toc-number">27.</span> <span class="toc-text">react-router-dom@6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96params"><span class="toc-number">27.1.</span> <span class="toc-text">获取params</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useNavigate-%E9%92%A9%E5%AD%90"><span class="toc-number">27.2.</span> <span class="toc-text">useNavigate(钩子)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%9A%84%E5%B5%8C%E5%A5%97%E5%92%8COutlt%E5%8D%A0%E4%BD%8D"><span class="toc-number">27.3.</span> <span class="toc-text">路由的嵌套和Outlt占位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Navigate%E7%BB%84%E4%BB%B6"><span class="toc-number">27.4.</span> <span class="toc-text">Navigate组件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NavLink-1"><span class="toc-number">27.5.</span> <span class="toc-text">NavLink</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E9%92%A9%E5%AD%90"><span class="toc-number">28.</span> <span class="toc-text">其他钩子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#useMemo"><span class="toc-number">28.1.</span> <span class="toc-text">useMemo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#React-forwardRef%E5%92%8CuseImperativeHandle"><span class="toc-number">28.2.</span> <span class="toc-text">React.forwardRef和useImperativeHandle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useEffect%E5%92%8CuseInsertionEffect%E5%92%8CuseLayoutEffect"><span class="toc-number">28.3.</span> <span class="toc-text">useEffect和useInsertionEffect和useLayoutEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#useDeferredValue"><span class="toc-number">28.4.</span> <span class="toc-text">useDeferredValue</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A2%8E%E7%AC%94%E8%AE%B0"><span class="toc-number">29.</span> <span class="toc-text">碎笔记</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/31d04109.html" title="java枚举和mybaits-plus结合实现映射输出和存储">java枚举和mybaits-plus结合实现映射输出和存储</a><time datetime="2025-05-26T20:23:14.000Z" title="发表于 2025-05-26 20:23:14">2025-05-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/dc4ed705.html" title="qq农场,牧场解包查看导出swf文件内容图片"><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202503251433885.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="qq农场,牧场解包查看导出swf文件内容图片"></a><div class="content"><a class="title" href="/dc4ed705.html" title="qq农场,牧场解包查看导出swf文件内容图片">qq农场,牧场解包查看导出swf文件内容图片</a><time datetime="2025-03-25T14:28:01.000Z" title="发表于 2025-03-25 14:28:01">2025-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/ed2e6c27.html" title="移动云盘加密分析-以链接有消息检查为例子"><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202503251433302.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="移动云盘加密分析-以链接有消息检查为例子"></a><div class="content"><a class="title" href="/ed2e6c27.html" title="移动云盘加密分析-以链接有消息检查为例子">移动云盘加密分析-以链接有消息检查为例子</a><time datetime="2025-03-22T12:24:10.000Z" title="发表于 2025-03-22 12:24:10">2025-03-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/3cde95bc.html" title="mstsc使用proxifier走clash代理降低延迟"><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202503030912164.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="mstsc使用proxifier走clash代理降低延迟"></a><div class="content"><a class="title" href="/3cde95bc.html" title="mstsc使用proxifier走clash代理降低延迟">mstsc使用proxifier走clash代理降低延迟</a><time datetime="2025-03-03T09:11:01.000Z" title="发表于 2025-03-03 09:11:01">2025-03-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/d6a2907d.html" title="适配FASTGPT基础AI模板-适合对付领导突发AI-奇想而生的模板"><img src="https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202502201550402.png" onerror='this.onerror=null,this.src="/img/404.png"' alt="适配FASTGPT基础AI模板-适合对付领导突发AI-奇想而生的模板"></a><div class="content"><a class="title" href="/d6a2907d.html" title="适配FASTGPT基础AI模板-适合对付领导突发AI-奇想而生的模板">适配FASTGPT基础AI模板-适合对付领导突发AI-奇想而生的模板</a><time datetime="2025-02-20T15:45:25.000Z" title="发表于 2025-02-20 15:45:25">2025-02-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://dreamos.oss-cn-beijing.aliyuncs.com/gitblog/202304091818601.png)"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By 梦洁</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://lib.baomitu.com/fancyapps-ui/5.0.33/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(()=>{let t=null;const e=()=>{if(t=Artalk.init(Object.assign({el:"#artalk-wrap",server:"https://artalk.dreamlove.top",site:"梦洁小站",pageKey:location.pathname,darkMode:"dark"===document.documentElement.getAttribute("data-theme")},null)),"null"===GLOBAL_CONFIG.lightbox)return;t.on("list-loaded",()=>{t.ctx.get("list").getCommentNodes().forEach(t=>{const e=t.getRender().$content;btf.loadLightbox(e.querySelectorAll("img:not([atk-emoticon])"))})});btf.addGlobalFn("pjax",()=>{t.destroy()},"destroyArtalk")},a=async()=>{"object"==typeof Artalk||(await getCSS("https://lib.baomitu.com/artalk/2.8.2/Artalk.min.css"),await getScript("https://lib.baomitu.com/artalk/2.8.2/Artalk.min.js")),e()};btf.addGlobalFn("themeChange",e=>{const a=document.getElementById("artalk-wrap");if(!a||!a.children.length)return;const l="dark"===e;t.setDarkMode(l)},"artalk"),a()})()</script></div><script id="canvas_nest" defer color="0,0,255" opacity="0.7" zindex="-1" count="99" mobile="false" src="https://lib.baomitu.com/butterfly-extsrc/1.1.3/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://lib.baomitu.com/algoliasearch/4.22.1/algoliasearch-lite.umd.min.js"></script><script src="https://lib.baomitu.com/instantsearch.js/4.65.0/instantsearch.production.min.js"></script><script src="/js/search/algolia.js?v=4.13.0"></script></div></div></body></html>